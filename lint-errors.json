[{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\piely react.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\analyze-canvas.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1290,1293],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1290,1293],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { createClient } from \"@/utils/supabase/server\";\r\nimport { generateObject } from \"ai\";\r\nimport { openai } from \"@ai-sdk/openai\";\r\nimport { z } from \"zod\";\r\n\r\nconst critiqueSchema = z.object({\r\n    critiques: z.array(z.object({\r\n        relatedNodeId: z.string().describe(\"The ID of the node this critique applies to\"),\r\n        title: z.string().describe(\"Short punchy title of the insight (e.g. 'Missing Metric')\"),\r\n        message: z.string().describe(\"The critique or suggestion (max 2 sentences)\"),\r\n        severity: z.enum([\"suggestion\", \"warning\"]).describe(\"Severity of the issue\"),\r\n    }))\r\n});\r\n\r\nexport async function analyzeCanvas(roadmapId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // 1. Fetch current nodes\r\n    const { data: nodes } = await supabase\r\n        .from(\"roadmap_nodes\")\r\n        .select(\"id, title, description, metadata\")\r\n        .eq(\"roadmap_id\", roadmapId)\r\n        .neq(\"type\", \"ghost\"); // Don't critique the critiques\r\n\r\n    if (!nodes || nodes.length === 0) {\r\n        return { error: \"No nodes to analyze\" };\r\n    }\r\n\r\n    // 2. Prepare Context for AI\r\n    const canvasContext = nodes.map(n => ({\r\n        id: n.id,\r\n        title: n.title,\r\n        description: n.description,\r\n        type: (n.metadata as any)?.moduleType || \"generic\"\r\n    }));\r\n\r\n    // 3. Generate Critique\r\n    const result = await generateObject({\r\n        model: openai(\"gpt-4o\"), // Or \"gpt-4-turbo\"\r\n        schema: critiqueSchema,\r\n        prompt: `\r\n      You are a YC Partner and Senior Product Architect.\r\n      Review the following Startup Canvas items.\r\n      Identify 3-5 critical gaps, risks, or improvement opportunities.\r\n      \r\n      Focus on:\r\n      1. Vagueness (\"Build App\" vs \"Launch MVP to 10 users\")\r\n      2. Missing GTM steps (Building without distribution)\r\n      3. Unrealistic goals.\r\n      \r\n      Canvas Items:\r\n      ${JSON.stringify(canvasContext, null, 2)}\r\n      \r\n      Return a list of critiques that should be attached to specific nodes.\r\n    `,\r\n    });\r\n\r\n    const critiques = result.object.critiques;\r\n\r\n    // 4. Insert Ghost Nodes\r\n    // We need to fetch the positions of related nodes to place the ghost node nearby\r\n    // ACTUALLY: We will just insert them, and let the Frontend (ReactFlow) or Layout Engine handle positioning initially?\r\n    // Or we can try to copy the related node's position + offset.\r\n    // For now, let's insert them with a temporary position (0,0) and let the Layout Engine logic update it?\r\n    // Or better: We fetch positions from the Frontend? No, server doesn't know.\r\n    // We will assume the frontend will receive the INSERT event and the Layout Engine will place them if the metadata links them.\r\n    // Let's store 'relatedNodeId' in metadata.\r\n\r\n    const critiqueNodes = critiques.map(c => ({\r\n        roadmap_id: roadmapId,\r\n        title: c.title,\r\n        description: c.message,\r\n        status: \"projected\", // Ghost nodes are always 'projected' (future/idea)\r\n        metadata: {\r\n            type: \"ghost\",\r\n            severity: c.severity,\r\n            relatedNodeId: c.relatedNodeId,\r\n            // Default Position (will be adjusted)\r\n            x: 0,\r\n            y: 0\r\n        }\r\n    }));\r\n\r\n    const { error } = await supabase\r\n        .from(\"roadmap_nodes\")\r\n        .insert(critiqueNodes);\r\n\r\n    if (error) {\r\n        console.error(\"Failed to insert critiques:\", error);\r\n        return { error: error.message };\r\n    }\r\n\r\n    return { success: true, count: critiques.length };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\auth.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[306,309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[306,309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[876,879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[876,879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { createClient } from \"@/utils/supabase/server\";\r\nimport { redirect } from \"next/navigation\";\r\n\r\nexport async function signOutAction() {\r\n    const supabase = await createClient();\r\n    await supabase.auth.signOut();\r\n    redirect(\"/\");\r\n}\r\n\r\nexport async function login(prevState: any, formData: FormData) {\r\n    const supabase = await createClient();\r\n    const data = {\r\n        email: formData.get(\"email\") as string,\r\n        password: formData.get(\"password\") as string,\r\n    };\r\n    const { error } = await supabase.auth.signInWithPassword(data);\r\n    if (error) {\r\n        // In a real app we'd adhere to progressive enhancement better or return state\r\n        // For this pattern we rely on the client refreshing or checking search params\r\n        throw error;\r\n    }\r\n    redirect(\"/dashboard\");\r\n}\r\n\r\nexport async function signup(prevState: any, formData: FormData) {\r\n    const supabase = await createClient();\r\n    const data = {\r\n        email: formData.get(\"email\") as string,\r\n        password: formData.get(\"password\") as string,\r\n    };\r\n    const { error } = await supabase.auth.signUp(data);\r\n    if (error) {\r\n        throw error;\r\n    }\r\n    redirect(\"/dashboard\");\r\n}\r\n\r\nexport async function loginWithOAuth(provider: \"google\", nextUrl?: string) {\r\n    const supabase = await createClient();\r\n    const redirectTo = nextUrl\r\n        ? `${process.env.NEXT_PUBLIC_SITE_URL}/auth/callback?next=${encodeURIComponent(nextUrl)}`\r\n        : `${process.env.NEXT_PUBLIC_SITE_URL}/auth/callback`;\r\n\r\n    const { data, error } = await supabase.auth.signInWithOAuth({\r\n        provider,\r\n        options: {\r\n            redirectTo,\r\n        },\r\n    });\r\n\r\n    if (error) {\r\n        throw error;\r\n    }\r\n\r\n    if (data.url) {\r\n        redirect(data.url);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\create-ai-node.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2125,2128],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2125,2128],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { createClient } from \"@/utils/supabase/server\";\r\nimport { Database } from \"@/lib/database.types\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ntype RoadmapNodeInsert = Database[\"public\"][\"Tables\"][\"roadmap_nodes\"][\"Insert\"];\r\n\r\nexport interface AINodeData {\r\n    title: string;\r\n    description: string;\r\n    type: \"product\" | \"gtm\" | \"hiring\" | \"funding\" | \"operations\";\r\n    stageId?: string;\r\n}\r\n\r\nexport interface CreateAINodeResult {\r\n    success: boolean;\r\n    nodeId?: string;\r\n    error?: string;\r\n}\r\n\r\n/**\r\n * Creates a new node on the canvas from AI-generated data.\r\n * This is the core action for the canvas-based AI response USP.\r\n */\r\nexport async function createAINode(\r\n    projectId: string,\r\n    nodeData: AINodeData\r\n): Promise<CreateAINodeResult> {\r\n    try {\r\n        const supabase = await createClient<Database>();\r\n\r\n        // Get current user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return { success: false, error: \"Authentication required\" };\r\n        }\r\n\r\n        // Verify project ownership\r\n        const { data: roadmap, error: roadmapError } = await supabase\r\n            .from(\"roadmaps\")\r\n            .select(\"id, user_id\")\r\n            .eq(\"id\", projectId)\r\n            .single();\r\n\r\n        if (roadmapError || !roadmap) {\r\n            return { success: false, error: \"Project not found\" };\r\n        }\r\n\r\n        if (roadmap.user_id !== user.id) {\r\n            return { success: false, error: \"Unauthorized\" };\r\n        }\r\n\r\n        // Get the highest order_index for positioning\r\n        const { data: existingNodes } = await supabase\r\n            .from(\"roadmap_nodes\")\r\n            .select(\"order_index, metadata\")\r\n            .eq(\"roadmap_id\", projectId)\r\n            .order(\"order_index\", { ascending: false })\r\n            .limit(1);\r\n\r\n        const lastOrderIndex = existingNodes?.[0]?.order_index ?? -1;\r\n        const newOrderIndex = lastOrderIndex + 1;\r\n\r\n        // Calculate position based on existing nodes\r\n        const lastMetadata = existingNodes?.[0]?.metadata as Record<string, any> | null;\r\n        const lastX = lastMetadata?.x ?? 0;\r\n        const newX = lastX + 280; // Offset for new node\r\n\r\n        // Insert the new node\r\n        const nodeToInsert: RoadmapNodeInsert = {\r\n            roadmap_id: projectId,\r\n            title: nodeData.title,\r\n            description: nodeData.description,\r\n            type: nodeData.type, // Database now accepts: stage, item, product, gtm, hiring, funding, operations\r\n            status: \"pending\",\r\n            order_index: newOrderIndex,\r\n            metadata: {\r\n                x: newX,\r\n                y: 120, // Offset below header\r\n                stageId: nodeData.stageId || \"validation\",\r\n                category: nodeData.type, // Store the actual category here\r\n                source: \"ai_chat\", // Mark as AI-generated from chat\r\n                createdAt: new Date().toISOString(),\r\n            },\r\n        };\r\n\r\n        const { data: newNode, error: insertError } = await supabase\r\n            .from(\"roadmap_nodes\")\r\n            .insert(nodeToInsert)\r\n            .select(\"id\")\r\n            .single();\r\n\r\n        if (insertError || !newNode) {\r\n            console.error(\"Failed to insert AI node:\", insertError);\r\n            return { success: false, error: \"Failed to create node\" };\r\n        }\r\n\r\n        // Revalidate the project page to show the new node\r\n        revalidatePath(`/project/${projectId}`);\r\n\r\n        return { success: true, nodeId: newNode.id };\r\n    } catch (error) {\r\n        console.error(\"createAINode error:\", error);\r\n        return { success: false, error: \"An unexpected error occurred\" };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\create-project.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'messages' is assigned a value but never used.","line":11,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":80},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[468,471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[468,471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2080,2083],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2080,2083],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3312,3315],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3312,3315],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { createClient } from \"@/utils/supabase/server\";\r\nimport { STAGES, StartupStage } from \"@/lib/stages\";\r\nimport { Database } from \"@/lib/database.types\";\r\nimport { generateStartupOS } from \"@/actions/generate-startup-os\";\r\nimport { CAMPUS_LAYOUT } from \"@/lib/campus-layout\";\r\n\r\ntype RoadmapNodeInsert = Database[\"public\"][\"Tables\"][\"roadmap_nodes\"][\"Insert\"];\r\n\r\nexport async function createProject(idea: string, stage: StartupStage, messages: any[] = []) {\r\n    const supabase = await createClient<Database>();\r\n\r\n    const {\r\n        data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n        throw new Error(\"Authentication required\");\r\n    }\r\n\r\n    // 1. Create Roadmap with AI-detected stage\r\n    const { data: roadmap, error: roadmapError } = await supabase\r\n        .from(\"roadmaps\")\r\n        .insert({\r\n            user_id: user.id,\r\n            title: idea || \"Untitled Project\",\r\n            idea_description: idea,\r\n            stage: stage, // Persist AI-detected stage for accelerator tracking\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n    if (roadmapError || !roadmap) {\r\n        throw new Error(roadmapError?.message || \"Failed to create project\");\r\n    }\r\n\r\n    // 2. Generate Startup OS (The 4 Quadrants)\r\n    const osData = await generateStartupOS(idea);\r\n\r\n    const nodesToInsert: RoadmapNodeInsert[] = [];\r\n    const stageDef = STAGES[stage] || STAGES.validation;\r\n\r\n    // Use a fixed order for consistency\r\n    const quadrants = [\r\n        { key: \"hq\", ...CAMPUS_LAYOUT.HQ, data: osData.hq, dbType: \"operations\" },\r\n        { key: \"market\", ...CAMPUS_LAYOUT.MARKET, data: osData.market, dbType: \"operations\" }, // Market research categorized as Ops/Strategy\r\n        { key: \"product\", ...CAMPUS_LAYOUT.PRODUCT, data: osData.product, dbType: \"product\" },\r\n        { key: \"gtm\", ...CAMPUS_LAYOUT.GTM, data: osData.gtm, dbType: \"gtm\" },\r\n    ];\r\n\r\n    quadrants.forEach((quadrant, index) => {\r\n        nodesToInsert.push({\r\n            roadmap_id: roadmap.id,\r\n            type: quadrant.dbType as any, // 'product' | 'gtm' | 'operations'\r\n            title: quadrant.data.title,\r\n            description: quadrant.data.description || quadrant.description,\r\n            status: \"in_progress\", // DB constraint: pending | in_progress | completed\r\n            order_index: index,\r\n            metadata: {\r\n                x: quadrant.x,\r\n                y: quadrant.y,\r\n                stageId: stageDef.id,\r\n                type: \"os_module\",\r\n                moduleType: quadrant.key,\r\n                data: quadrant.data // Stores the rich Chart/Table content\r\n            }\r\n        });\r\n    });\r\n\r\n    // 3. Insert Nodes and Capture IDs\r\n    const { data: insertedNodes, error: nodesError } = await supabase\r\n        .from(\"roadmap_nodes\")\r\n        .insert(nodesToInsert)\r\n        .select(\"id, metadata\");\r\n\r\n    if (nodesError || !insertedNodes) {\r\n        console.error(\"Nodes creation failed:\", nodesError);\r\n        return { id: roadmap.id };\r\n    }\r\n\r\n    // 4. Create Edges (Logic Flow)\r\n    // We need to map the inserted nodes back to their keys (hq, market, product, gtm)\r\n    const nodeMap = new Map<string, string>(); // moduleType -> id\r\n\r\n    insertedNodes.forEach(node => {\r\n        const meta = node.metadata as any;\r\n        if (meta?.moduleType) {\r\n            nodeMap.set(meta.moduleType, node.id);\r\n        }\r\n    });\r\n\r\n    const edgesToInsert = [];\r\n    const hqId = nodeMap.get(\"hq\");\r\n    const marketId = nodeMap.get(\"market\");\r\n    const productId = nodeMap.get(\"product\");\r\n    const gtmId = nodeMap.get(\"gtm\");\r\n\r\n    // Connect: HQ -> Product (\"Vision drives Product\")\r\n    if (hqId && productId) {\r\n        edgesToInsert.push({ roadmap_id: roadmap.id, from_node_id: hqId, to_node_id: productId, type: \"precedes\" });\r\n    }\r\n    // Connect: Market -> Product (\"Market needs drive Features\")\r\n    if (marketId && productId) {\r\n        edgesToInsert.push({ roadmap_id: roadmap.id, from_node_id: marketId, to_node_id: productId, type: \"precedes\" });\r\n    }\r\n    // Connect: Product -> GTM (\"Product enables Sales\")\r\n    if (productId && gtmId) {\r\n        edgesToInsert.push({ roadmap_id: roadmap.id, from_node_id: productId, to_node_id: gtmId, type: \"precedes\" });\r\n    }\r\n\r\n    if (edgesToInsert.length > 0) {\r\n        await supabase.from(\"roadmap_edges\").insert(edgesToInsert);\r\n    }\r\n\r\n    // Update title if HQ has a better name (optional, keeping simple for now)\r\n\r\n    // 4. Return ID for client to redirect\r\n    return { id: roadmap.id };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\execute-tool.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":5,"column":90,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":93,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[165,168],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[165,168],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_' is assigned a value but never used.","line":24,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2893,2896],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2893,2896],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { createClient } from \"@/utils/supabase/server\";\r\n\r\nexport async function executeTool(toolId: string, nodeId: string, inputs: Record<string, any>) {\r\n    const supabase = await createClient();\r\n\r\n    if (toolId === \"deploy_vercel\") {\r\n        const vercelToken = process.env.VERCEL_TOKEN;\r\n\r\n        if (!vercelToken) {\r\n            return { success: false, message: \"Server Error: VERCEL_TOKEN missing in environment variables.\" };\r\n        }\r\n\r\n        // 1. Parse Repo URL to extract user/repo\r\n        // Expected format: https://github.com/user/repo\r\n        const repoUrl = inputs.repoUrl;\r\n        const match = repoUrl.match(/github\\.com\\/([^\\/]+)\\/([^\\/]+)/);\r\n\r\n        if (!match) {\r\n            return { success: false, message: \"Invalid GitHub URL. Format: https://github.com/user/repo\" };\r\n        }\r\n\r\n        const [_, org, repo] = match;\r\n        // Remove .git if present\r\n        const cleanRepo = repo.replace(/\\.git$/, \"\");\r\n        const repoString = `${org}/${cleanRepo}`;\r\n\r\n        try {\r\n            // 2. Call Vercel API to create a deployment\r\n            // Docs: https://vercel.com/docs/rest-api/endpoints/deployments#create-a-new-deployment\r\n            const response = await fetch(\"https://api.vercel.com/v13/deployments\", {\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Authorization\": `Bearer ${vercelToken}`,\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify({\r\n                    name: cleanRepo, // Project name\r\n                    gitSource: {\r\n                        type: \"github\",\r\n                        repo: repoString,\r\n                        ref: \"main\" // Defaulting to main, could be an input\r\n                    },\r\n                    projectSettings: {\r\n                        framework: null // Auto-detect\r\n                    }\r\n                }),\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                console.error(\"Vercel API Error:\", data);\r\n                return { success: false, message: `Vercel Deployment Failed: ${data.error?.message || \"Unknown error\"}` };\r\n            }\r\n\r\n            // 3. Log success\r\n            await supabase.from(\"node_chat_messages\").insert({\r\n                node_id: nodeId,\r\n                role: \"assistant\",\r\n                content: `ðŸš€ **Deployment Triggered!**\\n\\n**Project:** ${data.name}\\n**Inspector URL:** [View Deployment](${data.inspectorUrl})\\n**Target:** Vercel`,\r\n            });\r\n\r\n            // 4. Update Node Status (Optional - e.g. set to 'in_progress')\r\n            await supabase.from(\"roadmap_nodes\").update({ status: \"in_progress\" }).eq(\"id\", nodeId);\r\n\r\n            return { success: true, message: \"Deployment started successfully on Vercel!\" };\r\n\r\n        } catch (error: any) {\r\n            console.error(\"Execute Tool Error:\", error);\r\n            return { success: false, message: `Execution failed: ${error.message}` };\r\n        }\r\n    }\r\n\r\n    return { success: false, message: \"Tool logic not implemented for this ID.\" };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\fetch-node-context.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[520,523],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[520,523],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[545,548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[545,548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[949,952],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[949,952],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { createClient } from \"@/utils/supabase/server\";\r\n\r\nexport async function fetchNodeContext(nodeId: string) {\r\n    const supabase = await createClient();\r\n\r\n    // 1. Fetch text data\r\n    const { data: node } = await supabase\r\n        .from(\"roadmap_nodes\")\r\n        .select(\"*, roadmaps(title, idea_description)\")\r\n        .eq(\"id\", nodeId)\r\n        .single();\r\n\r\n    if (!node) return null;\r\n\r\n    // 2. Fetch Siblings (nodes in same stage)\r\n    const metadata = node.metadata as Record<string, any>;\r\n    let siblings: any[] = [];\r\n    if (metadata?.stageId) {\r\n        const { data: sibs } = await supabase\r\n            .from(\"roadmap_nodes\")\r\n            .select(\"title\")\r\n            .eq(\"roadmap_id\", node.roadmap_id)\r\n            .neq(\"id\", nodeId);  // Exclude self\r\n\r\n        // Filter manually for stageId if it's in metadata (JSON col processing is easier in JS)\r\n        siblings = (sibs || []).filter(s => (s as any).metadata?.stageId === metadata.stageId);\r\n    }\r\n\r\n    return {\r\n        node,\r\n        project: node.roadmaps,\r\n        siblings: siblings.map(s => s.title)\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\generate-startup-os.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'OSBlockSchema' is defined but never used.","line":5,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":39,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"OSBlockSchema"},"fix":{"range":[120,135],"text":""},"desc":"Remove unused variable \"OSBlockSchema\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2472,2475],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2472,2475],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { generateObject } from \"ai\";\r\nimport { openai } from \"@ai-sdk/openai\";\r\nimport { OSModuleSchema, OSBlockSchema } from \"@/lib/schemas/os-modules\";\r\nimport { z } from \"zod\";\r\n\r\nexport interface StartupOSResult {\r\n    hq: z.infer<typeof OSModuleSchema>;\r\n    market: z.infer<typeof OSModuleSchema>;\r\n    product: z.infer<typeof OSModuleSchema>;\r\n    gtm: z.infer<typeof OSModuleSchema>;\r\n}\r\n\r\n// Helper to generate a single module\r\nasync function generateModule(\r\n    idea: string,\r\n    moduleType: \"hq\" | \"market\" | \"product\" | \"gtm\",\r\n    description: string\r\n) {\r\n    try {\r\n        const { object } = await generateObject({\r\n            model: openai(\"gpt-4o\"), // Use 4o for complex structure\r\n            schema: OSModuleSchema,\r\n            prompt: `\r\n        You are an expert YC Startup Advisor and Product Manager.\r\n        The user has a startup idea: \"${idea}\".\r\n        \r\n        Generate a detailed visual \"${moduleType.toUpperCase()}\" module for their Startup Dashboard.\r\n        Context: ${description}\r\n        \r\n        Requirements:\r\n        1. Create a rich layout with 3-5 blocks (Metrics, Charts, Tables, Markdown).\r\n        2. Content must be specific to the idea, not generic.\r\n        3. For Charts: Use \"bar\", \"line\", or \"pie\".\r\n        4. For Metrics: Include realistic projections or standard benchmarks.\r\n        5. For Tables: Compare competitors or list features.\r\n        6. IMPORTANT: The \"data\" field must be a STRINGIFIED JSON array (e.g. \"[{...}]\"), not a raw array.\r\n        \r\n        Output valid JSON matching the schema.\r\n      `,\r\n        });\r\n\r\n        // Parse the data fields back into objects\r\n        const parsedLayout = object.layout.map(block => {\r\n            if (block.data && typeof block.data === 'string') {\r\n                try {\r\n                    return { ...block, data: JSON.parse(block.data) };\r\n                } catch (e) {\r\n                    console.error(\"Failed to parse block data JSON:\", e);\r\n                    return { ...block, data: [] };\r\n                }\r\n            }\r\n            return block;\r\n        });\r\n\r\n        return { ...object, layout: parsedLayout };\r\n    } catch (error) {\r\n        console.error(`Error generating ${moduleType}:`, error);\r\n        // Return a fallback error module\r\n        return {\r\n            title: `${moduleType.toUpperCase()} Error`,\r\n            layout: [{ type: \"markdown\", content: \"Failed to generate content.\" }],\r\n        } as any;\r\n    }\r\n}\r\n\r\nexport async function generateStartupOS(idea: string): Promise<StartupOSResult> {\r\n\r\n    // Parallel Execution\r\n    const [hq, market, product, gtm] = await Promise.all([\r\n        generateModule(\r\n            idea,\r\n            \"hq\",\r\n            \"Headquarters: Mission Statement, Vision, Founding Team Roles needed, and North Star Metric.\"\r\n        ),\r\n        generateModule(\r\n            idea,\r\n            \"market\",\r\n            \"Market Intelligence: TAM/SAM/SOM breakdown, Competitor Analysis Table, and Market Trends Chart.\"\r\n        ),\r\n        generateModule(\r\n            idea,\r\n            \"product\",\r\n            \"Product Engine: MVP Feature List (Table), Development Timeline (Chart), and Tech Stack recommendation.\"\r\n        ),\r\n        generateModule(\r\n            idea,\r\n            \"gtm\",\r\n            \"Go-To-Market Command: Pitch Deck Outline (Markdown), Sales Funnel projection (Chart), and Marketing Channels.\"\r\n        ),\r\n    ]);\r\n\r\n    return { hq, market, product, gtm };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\metrics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\node-attachments.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'uploadData' is assigned a value but never used.","line":20,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'fileName' is defined but never used.","line":62,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":64}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport { createClient } from \"@/utils/supabase/server\";\r\n\r\nconst BUCKET_NAME = \"node-attachments\";\r\n\r\nexport async function uploadNodeAttachment(formData: FormData) {\r\n    const file = formData.get(\"file\") as File;\r\n    const nodeId = formData.get(\"nodeId\") as string;\r\n\r\n    if (!file || !nodeId) return { error: \"Missing file or node ID\" };\r\n\r\n    const supabase = await createClient();\r\n\r\n    // 1. Upload to Supabase Storage\r\n    // Generate a unique path: {nodeId}/{timestamp}-{filename}\r\n    const fileExt = file.name.split(\".\").pop();\r\n    const filePath = `${nodeId}/${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`;\r\n\r\n    const { data: uploadData, error: uploadError } = await supabase.storage\r\n        .from(BUCKET_NAME)\r\n        .upload(filePath, file);\r\n\r\n    if (uploadError) {\r\n        console.error(\"Storage upload error:\", uploadError);\r\n        return { error: `Upload failed: ${uploadError.message}` };\r\n    }\r\n\r\n    // 2. Insert record into database\r\n    const publicUrl = supabase.storage.from(BUCKET_NAME).getPublicUrl(filePath).data.publicUrl;\r\n\r\n    const { error: dbError } = await supabase\r\n        .from(\"node_attachments\")\r\n        .insert({\r\n            node_id: nodeId,\r\n            file_name: file.name,\r\n            file_type: file.type,\r\n            file_size: file.size,\r\n            file_url: publicUrl, // Storing public URL for easy access. \r\n            // Note: For private buckets, we might store the path and sign URLs on fetch.\r\n            // Assuming public read access for this bucket for simplicity in this sprint.\r\n        });\r\n\r\n    if (dbError) {\r\n        return { error: `Database error: ${dbError.message}` };\r\n    }\r\n\r\n    return { success: true };\r\n}\r\n\r\nexport async function fetchNodeAttachments(nodeId: string) {\r\n    const supabase = await createClient();\r\n    const { data } = await supabase\r\n        .from(\"node_attachments\")\r\n        .select(\"*\")\r\n        .eq(\"node_id\", nodeId)\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n    return data || [];\r\n}\r\n\r\nexport async function deleteNodeAttachment(id: string, fileName: string) { // fileName is not path, need to retrieve path? \r\n    // Actually, we need the stored path in the bucket to delete from storage.\r\n    // But we saved publicUrl...\r\n    // Let's optimize: fetch the record first to get metadata if needed, \r\n    // OR just delete from DB and let a cron job clean up storage? \r\n    // Better: Extract path from URL or store path in DB. \r\n    // I didn't store 'storage_path' in DB migration. \r\n    // I will just delete from DB for now to hide it from UI. \r\n    // Ideally we should fix schema to store `storage_path`.\r\n\r\n    const supabase = await createClient();\r\n\r\n    // 1. Delete from DB\r\n    const { error } = await supabase\r\n        .from(\"node_attachments\")\r\n        .delete()\r\n        .eq(\"id\", id);\r\n\r\n    if (error) return { error: error.message };\r\n\r\n    return { success: true };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\node-chat.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\actions\\solana-auth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'newUser' is assigned a value but never used.","line":92,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":38},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":118,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4765,4768],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4765,4768],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport crypto from \"crypto\";\r\nimport nacl from \"tweetnacl\";\r\nimport bs58 from \"bs58\";\r\nimport { createClient } from \"@/utils/supabase/server\";\r\nimport { createClient as createAdminClient } from \"@supabase/supabase-js\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\ninterface VerifySolanaParams {\r\n    publicKey: string;\r\n    signature: string; // Base58 encoded signature from client\r\n    message: string;   // The raw message string signed by the user\r\n}\r\n\r\n// Deterministic salt for Solana identity bridge\r\nconst SOLANA_AUTH_SECRET = \"piely_architect_secure_salt_v1\";\r\n\r\nexport async function verifySolanaLogin({ publicKey, signature, message }: VerifySolanaParams) {\r\n    try {\r\n        const signatureBytes = bs58.decode(signature);\r\n        const publicKeyBytes = bs58.decode(publicKey);\r\n        const messageBytes = new TextEncoder().encode(message);\r\n\r\n        const verified = nacl.sign.detached.verify(\r\n            messageBytes,\r\n            signatureBytes,\r\n            publicKeyBytes\r\n        );\r\n\r\n        if (!verified) {\r\n            return { error: \"Signature verification failed\" };\r\n        }\r\n\r\n        // Verification Successful!\r\n        const supabase = await createClient(); // Context-aware client (sets cookies)\r\n\r\n        // Admin client for privileged operations (bypassing email confirmation)\r\n        const supabaseAdmin = createAdminClient(\r\n            process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n            process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n        );\r\n\r\n        const email = `${publicKey}@solana.piely.app`;\r\n\r\n        // Deterministic password based on public key and server secret\r\n        // Hash it to ensure it stays within 72 char limit (SHA-256 hex is 64 chars)\r\n        const rawPassword = `${publicKey}_${SOLANA_AUTH_SECRET}`;\r\n        const password = crypto.createHash('sha256').update(rawPassword).digest('hex');\r\n\r\n        // 1. Try to sign in\r\n        const { data: signInData, error: signInError } = await supabase.auth.signInWithPassword({\r\n            email,\r\n            password\r\n        });\r\n\r\n        // 2. Handle Errors\r\n        if (signInError) {\r\n\r\n            // CASE A: User exists but email not confirmed (Common when dashboard requires confirmation)\r\n            if (signInError.code === \"email_not_confirmed\") {\r\n                // Find user ID to confirm them directly\r\n                const { data: { users }, error: listError } = await supabaseAdmin.auth.admin.listUsers();\r\n\r\n                if (listError) console.error(\"Admin: List users error\", listError);\r\n\r\n                // Supabase stores emails in lowercase, but our generated email might have mixed case public key\r\n                const userToConfirm = users?.find(u => u.email?.toLowerCase() === email.toLowerCase());\r\n\r\n                if (userToConfirm) {\r\n                    const { error: updateError } = await supabaseAdmin.auth.admin.updateUserById(userToConfirm.id, {\r\n                        email_confirm: true\r\n                    });\r\n\r\n                    if (updateError) console.error(\"Admin: Update user error\", updateError);\r\n\r\n                    // Retry Sign In\r\n                    const repost = await supabase.auth.signInWithPassword({ email, password });\r\n                    if (repost.error) {\r\n                        console.error(\"Admin: Retry login failed\", repost.error);\r\n                        throw repost.error;\r\n                    }\r\n\r\n                    revalidatePath(\"/\", \"layout\");\r\n                    return { success: true, user: repost.data.user };\r\n                }\r\n            }\r\n\r\n            // CASE B: User doesn't exist (\"Invalid login credentials\")\r\n            if (signInError.message.includes(\"Invalid login credentials\")) {\r\n                // Create pre-confirmed user via Admin API\r\n                const { data: newUser, error: createError } = await supabaseAdmin.auth.admin.createUser({\r\n                    email,\r\n                    password,\r\n                    email_confirm: true, // Bypass confirmation\r\n                    user_metadata: {\r\n                        wallet_address: publicKey,\r\n                        auth_method: \"solana\"\r\n                    }\r\n                });\r\n\r\n                if (createError) throw createError;\r\n\r\n                // Sign In to set session cookies\r\n                const repost = await supabase.auth.signInWithPassword({ email, password });\r\n                if (repost.error) throw repost.error;\r\n\r\n                revalidatePath(\"/\", \"layout\");\r\n                return { success: true, user: repost.data.user };\r\n            }\r\n\r\n            throw signInError;\r\n        }\r\n\r\n        revalidatePath(\"/\", \"layout\");\r\n        return { success: true, user: signInData.user };\r\n\r\n    } catch (error: any) {\r\n        console.error(\"Solana Verification Error:\", error);\r\n        return { error: error.message || \"Verification process failed\" };\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\chat\\node\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\chat\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\generate-os\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\generate-roadmap\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'detailLevel' is defined but never used.","line":91,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\nimport { generateObject } from \"ai\";\nimport { openai } from \"@ai-sdk/openai\";\nimport {\n  roadmapDetailLevelSchema,\n  roadmapResponseSchema,\n  roadmapStageIdSchema,\n} from \"@/lib/roadmapSchema\";\nimport type { RoadmapDetailLevel, RoadmapStageId } from \"@/lib/roadmapTypes\";\nimport { researchStartupIdea } from \"@/lib/research\";\n\nexport const maxDuration = 60;\n\ninterface GenerateRoadmapRequestBody {\n  idea: string;\n  focusStage?: RoadmapStageId;\n  detailLevel?: RoadmapDetailLevel;\n  includeResearch?: boolean;\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = (await request.json()) as Partial<GenerateRoadmapRequestBody>;\n\n    if (!body.idea || typeof body.idea !== \"string\") {\n      return NextResponse.json(\n        { error: \"Missing or invalid 'idea' field\" },\n        { status: 400 },\n      );\n    }\n\n    const focusStage = body.focusStage\n      ? roadmapStageIdSchema.parse(body.focusStage)\n      : undefined;\n    const detailLevel = body.detailLevel\n      ? roadmapDetailLevelSchema.parse(body.detailLevel)\n      : (\"high_level\" as RoadmapDetailLevel);\n\n    const includeResearch = body.includeResearch ?? false;\n    let researchInsights = null;\n\n    if (includeResearch) {\n      researchInsights = await researchStartupIdea(body.idea);\n    }\n\n    if (!process.env.OPENAI_API_KEY) {\n      const stubRoadmap = buildStubRoadmap(body.idea, focusStage, detailLevel);\n      return NextResponse.json(roadmapResponseSchema.parse(stubRoadmap));\n    }\n\n    const { object: roadmap } = await generateObject({\n      model: openai(\"gpt-4o-mini\"),\n      temperature: 0.7,\n      schema: roadmapResponseSchema,\n      system:\n        \"You are an experienced startup operator and product strategist. \" +\n        \"Given a startup idea, you design an execution roadmap from idea to IPO. \" +\n        \"Be DIRECT and no-BS: 'Do X, then Y. Don't do Z because...' But also explain WHY in 1-2 sentences when relevant. \" +\n        \"Stages should be ordered from earliest to latest using 'stageOrder'. \" +\n        \"Create 5-10 big milestones per stage, and each milestone can branch into smaller actionable tasks. \" +\n        \"Adapt stages to the specific startup idea - don't force standard stages if they don't fit. \" +\n        \"Choose a layoutType that best represents the roadmap structure visually (timeline, tree, swimlanes, radial, flow, custom).\",\n      prompt:\n        `Startup idea: ${body.idea}\\n` +\n        `Focus stage: ${focusStage ?? \"all\"}\\n` +\n        `Detail level: ${detailLevel ?? \"high_level\"}` +\n        (researchInsights\n          ? `\\n\\nResearch insights:\\n` +\n          (researchInsights.competitors\n            ? `Competitors: ${researchInsights.competitors.join(\", \")}\\n`\n            : \"\") +\n          (researchInsights.marketTrends\n            ? `Market trends: ${researchInsights.marketTrends.join(\"; \")}\\n`\n            : \"\")\n          : \"\"),\n    });\n\n    return NextResponse.json(roadmap);\n  } catch (error) {\n    console.error(\"generate-roadmap error\", error);\n    return NextResponse.json(\n      { error: \"Failed to generate roadmap\" },\n      { status: 500 },\n    );\n  }\n}\n\nfunction buildStubRoadmap(\n  idea: string,\n  focusStage?: RoadmapStageId,\n  detailLevel?: RoadmapDetailLevel,\n) {\n  const stagesOrder: RoadmapStageId[] = [\n    \"idea\",\n    \"validation\",\n    \"build\",\n    \"launch\",\n    \"growth\",\n    \"scale\",\n    \"ipo\",\n  ];\n\n  const activeStages = focusStage ? [focusStage] : stagesOrder;\n\n  const stages = activeStages.map((stageId, index) => ({\n    id: stageId,\n    name: stageId.toUpperCase(),\n    stageOrder: index,\n    description: `High-level ${stageId} stage for \"${idea}\".`,\n    timeline: undefined,\n  }));\n\n  const items = stages.flatMap((stage) => {\n    const baseId = stage.id;\n    return [\n      {\n        id: `${baseId}-1`,\n        title: `${stage.name} milestone 1`,\n        stageId: stage.id,\n        category: \"product\" as const,\n        description: `First key milestone in the ${stage.name} stage.`,\n        difficulty: \"medium\" as const,\n        impact: \"high\" as const,\n        dependencies: [],\n      },\n      {\n        id: `${baseId}-2`,\n        title: `${stage.name} milestone 2`,\n        stageId: stage.id,\n        category: \"gtm\" as const,\n        description: `Second key milestone in the ${stage.name} stage.`,\n        difficulty: \"medium\" as const,\n        impact: \"medium\" as const,\n        dependencies: [`${baseId}-1`],\n      },\n    ];\n  });\n\n  const edges = items\n    .filter((item) => item.dependencies.length > 0)\n    .map((item) => ({\n      id: `${item.id}-edge`,\n      from: item.dependencies[0],\n      to: item.id,\n      type: \"depends_on\" as const,\n    }));\n\n  return { stages, items, edges };\n}\n\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\generate-variants\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\nodes\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\roadmaps\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\api\\webhooks\\external\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'body' is assigned a value but never used.","line":5,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from \"@/utils/supabase/server\";\r\nimport { headers } from \"next/headers\";\r\n\r\nexport async function POST(req: Request) {\r\n    const body = await req.json();\r\n    const headersList = await headers();\r\n\r\n    // 1. Verify Secret\r\n    const secretKey = headersList.get(\"x-webhook-secret\");\r\n\r\n    if (!secretKey) {\r\n        return new Response(\"Missing Secret\", { status: 401 });\r\n    }\r\n\r\n    const supabase = await createClient();\r\n\r\n    // 2. Find matching webhook configuration\r\n    const { data: webhook } = await supabase\r\n        .from(\"node_webhooks\")\r\n        .select(\"id, node_id, is_active\")\r\n        .eq(\"secret_key\", secretKey)\r\n        .single();\r\n\r\n    if (!webhook || !webhook.is_active) {\r\n        return new Response(\"Invalid or Inactive Webhook\", { status: 403 });\r\n    }\r\n\r\n    // 3. Process Event (Mock Logic)\r\n    // In a real app, we would switch(provider) and validate the payload signature\r\n\r\n    // Update Node Status to 'completed'\r\n    await supabase\r\n        .from(\"roadmap_nodes\")\r\n        .update({ status: \"completed\" })\r\n        .eq(\"id\", webhook.node_id);\r\n\r\n    // Log to Chat History\r\n    await supabase.from(\"node_chat_messages\").insert({\r\n        node_id: webhook.node_id,\r\n        role: \"assistant\", // Using assistant for system notifications\r\n        content: `âš¡ **Webhook Event:** Received payload. Node marked as completed.`,\r\n    });\r\n\r\n    // Update Last Triggered\r\n    await supabase\r\n        .from(\"node_webhooks\")\r\n        .update({ last_triggered_at: new Date().toISOString() })\r\n        .eq(\"id\", webhook.id);\r\n\r\n    return new Response(\"Webhook Processed\", { status: 200 });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\auth\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WalletMultiButton' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":27,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"WalletMultiButton"},"fix":{"range":[357,425],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'connection' is assigned a value but never used.","line":21,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'state' is assigned a value but never used.","line":25,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'signupState' is assigned a value but never used.","line":26,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":23},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\auth\\page.tsx:37:9\n  35 |\n  36 |     useEffect(() => {\n> 37 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  38 |         // ... (Keep existing useEffect)\n  39 |         const storedIdea = localStorage.getItem(\"piely_startup_idea\");\n  40 |         if (storedIdea) {","line":37,"column":9,"nodeType":null,"endLine":37,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":77,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":23},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":106,"column":36,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4091,4137],"text":"\r\n                                Let&apos;s build "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4091,4137],"text":"\r\n                                Let&lsquo;s build "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4091,4137],"text":"\r\n                                Let&#39;s build "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4091,4137],"text":"\r\n                                Let&rsquo;s build "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState, useActionState, Suspense } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { ArrowRight, Lock } from \"lucide-react\";\r\nimport { login, signup, loginWithOAuth } from \"@/actions/auth\";\r\n\r\nimport { verifySolanaLogin } from \"@/actions/solana-auth\";\r\nimport bs58 from \"bs58\";\r\n\r\nimport { WalletMultiButton } from \"@solana/wallet-adapter-react-ui\";\r\nimport { useWallet, useConnection } from \"@solana/wallet-adapter-react\";\r\nimport { useWalletModal } from \"@solana/wallet-adapter-react-ui\";\r\n\r\nfunction AuthPageContent() {\r\n    const router = useRouter();\r\n    const searchParams = useSearchParams();\r\n    const [idea, setIdea] = useState<string | null>(null);\r\n    const { connected, publicKey, signMessage } = useWallet();\r\n    const { setVisible } = useWalletModal(); // Modal Control\r\n    const { connection } = useConnection();\r\n    const [mode, setMode] = useState<\"login\" | \"signup\">(\"login\");\r\n\r\n    // Server Actions Hooks\r\n    const [state, formAction, isPending] = useActionState(login, null);\r\n    const [signupState, signupAction] = useActionState(signup, null);\r\n\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    // Determine redirect destination\r\n    const intent = searchParams.get(\"intent\");\r\n    const nextUrl = (intent === \"onboarding_complete\" || intent === \"build\")\r\n        ? \"/onboarding\"\r\n        : searchParams.get(\"next\") || \"/dashboard\";\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        // ... (Keep existing useEffect)\r\n        const storedIdea = localStorage.getItem(\"piely_startup_idea\");\r\n        if (storedIdea) {\r\n            setIdea(storedIdea);\r\n        }\r\n    }, []);\r\n\r\n    const handleGoogleLogin = async () => {\r\n        await loginWithOAuth(\"google\", nextUrl);\r\n    };\r\n\r\n    const handleSolanaSignIn = async () => {\r\n        if (!connected || !publicKey || !signMessage) return;\r\n\r\n        try {\r\n            const message = new TextEncoder().encode(\r\n                `Sign in to Piely with Solana\\nWallet: ${publicKey.toBase58()}\\nTimestamp: ${Date.now()}`\r\n            );\r\n\r\n            const signature = await signMessage(message);\r\n\r\n            // Send to backend for verification\r\n            const serializedSignature = bs58.encode(signature);\r\n            const serializedMessage = new TextDecoder().decode(message);\r\n\r\n            const result = await verifySolanaLogin({\r\n                publicKey: publicKey.toBase58(),\r\n                signature: serializedSignature,\r\n                message: serializedMessage\r\n            });\r\n\r\n            if (result.success) {\r\n                // Determine destination based on if we have a project staged\r\n                router.push(nextUrl);\r\n            } else {\r\n                alert(\"Verification Failed: \" + result.error);\r\n            }\r\n\r\n\r\n        } catch (error) {\r\n            // Silently fail or handled by UI\r\n        }\r\n\r\n    };\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"min-h-screen grid grid-cols-1 lg:grid-cols-2 bg-background text-foreground\">\r\n            {/* ... (Keep Left Panel) ... */}\r\n            <div className=\"hidden lg:flex flex-col justify-between p-12 bg-gray-50 dark:bg-zinc-900 border-r border-border relative overflow-hidden\">\r\n                {/* ... (Keep Background & Branding) ... */}\r\n                <div className=\"absolute inset-0 opacity-10\"\r\n                    style={{\r\n                        backgroundImage: `radial-gradient(circle at 2px 2px, gray 1px, transparent 0)`,\r\n                        backgroundSize: `24px 24px`\r\n                    }}\r\n                />\r\n\r\n                <div className=\"z-10\">\r\n                    <div className=\"flex items-center gap-2 mb-8\">\r\n                        <div className=\"w-6 h-6 bg-foreground rounded-sm\" />\r\n                        <span className=\"font-heading font-bold text-xl tracking-tight\">Piely</span>\r\n                    </div>\r\n\r\n                    <h2 className=\"text-4xl font-heading font-semibold leading-tight mb-4\">\r\n                        {idea ? (\r\n                            <>\r\n                                Let's build <br />\r\n                                <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-blue-600\">\r\n                                    {idea}\r\n                                </span>\r\n                            </>\r\n                        ) : (\r\n                            \"Architect your next big thing.\"\r\n                        )}\r\n                    </h2>\r\n                    <p className=\"text-muted-foreground font-light max-w-md\">\r\n                        Join 10,000+ founders using Ghost Nodes to validate, build, and scale their SaaS.\r\n                    </p>\r\n                </div>\r\n\r\n                <div className=\"z-10\">\r\n                    <div className=\"p-6 bg-background rounded-lg border border-border shadow-sm max-w-sm\">\r\n                        <div className=\"flex items-center gap-3 mb-3\">\r\n                            <div className=\"w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900/20 flex items-center justify-center text-orange-600 dark:text-orange-400\">\r\n                                <Lock className=\"w-4 h-4\" />\r\n                            </div>\r\n                            <div>\r\n                                <div className=\"text-sm font-semibold\">Secure Workspace</div>\r\n                                <div className=\"text-xs text-muted-foreground\">End-to-end encrypted</div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"h-2 w-full bg-gray-100 dark:bg-zinc-800 rounded-full overflow-hidden\">\r\n                            <div className=\"h-full w-2/3 bg-orange-500 rounded-full\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Right Panel: The Gate */}\r\n            <div className=\"flex items-center justify-center p-8\">\r\n                <div className=\"w-full max-w-md space-y-8\">\r\n                    <div className=\"text-center lg:text-left\">\r\n                        <h1 className=\"text-2xl font-bold font-heading\">Sign in to your account</h1>\r\n                        <p className=\"text-sm text-muted-foreground mt-2\">\r\n                            {intent === 'onboarding_complete' ? (\r\n                                <span className=\"text-orange-600 font-medium\">Save your project to continue.</span>\r\n                            ) : (\r\n                                \"Start your intelligent building journey.\"\r\n                            )}\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        {/* Web2: Google */}\r\n                        <button\r\n                            onClick={handleGoogleLogin}\r\n                            disabled={isPending}\r\n                            className=\"w-full flex items-center justify-center gap-2 bg-white dark:bg-zinc-800 border border-border text-foreground py-2.5 rounded-sm hover:bg-gray-50 dark:hover:bg-zinc-700 transition-all font-medium shadow-sm\"\r\n                        >\r\n                            <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\">\r\n                                <path\r\n                                    d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\"\r\n                                    fill=\"#4285F4\"\r\n                                />\r\n                                <path\r\n                                    d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\"\r\n                                    fill=\"#34A853\"\r\n                                />\r\n                                <path\r\n                                    d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\"\r\n                                    fill=\"#FBBC05\"\r\n                                />\r\n                                <path\r\n                                    d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\"\r\n                                    fill=\"#EA4335\"\r\n                                />\r\n                            </svg>\r\n                            Continue with Google\r\n                        </button>\r\n\r\n                        {/* Web3: Solana */}\r\n                        {/* Web3: Solana Unified Button */}\r\n                        <div className=\"w-full flex justify-center\">\r\n                            {mounted && (\r\n                                <button\r\n                                    onClick={() => {\r\n                                        if (connected) {\r\n                                            handleSolanaSignIn();\r\n                                        } else {\r\n                                            setVisible(true);\r\n                                        }\r\n                                    }}\r\n                                    className=\"w-full flex items-center justify-center gap-2 bg-[#9945FF] text-white py-2.5 rounded-sm hover:bg-[#7c37cc] transition-all font-medium shadow-sm transition-transform active:scale-[0.98]\"\r\n                                >\r\n                                    <svg viewBox=\"0 0 397 311\" className=\"w-4 h-4 fill-current\">\r\n                                        <path d=\"M64.6 237.9c2.4-2.4 5.7-3.8 9.2-3.8h317.4c5.8 0 8.7 7 4.6 11.1l-62.7 62.7c-2.4 2.4-5.7 3.8-9.2 3.8H6.5c-5.8 0-8.7-7-4.6-11.1l62.7-62.7zm0-160c2.4-2.4 5.7-3.8 9.2-3.8h317.4c5.8 0 8.7 7 4.6 11.1l-62.7 62.7c-2.4 2.4-5.7 3.8-9.2 3.8H6.5c-5.8 0-8.7-7-4.6-11.1l62.7-62.7zm325.9-81.8l-62.7 62.7c-2.4 2.4-5.7 3.8-9.2 3.8H6.5c-5.8 0-8.7-7-4.6-11.1l62.7-62.7c2.4-2.4 5.7-3.8 9.2-3.8h317.4c5.8 0 8.7 7 4.6 11.1z\" />\r\n                                    </svg>\r\n                                    {connected ? \"Verify & Sign In\" : \"Connect Wallet\"}\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Hidden Standard Button to keep Adapter Logic happy if needed, but usually Provider handles it */}\r\n                        {/* We use useWalletModal so we don't need the default button visible */}\r\n\r\n                        {connected && (\r\n                            <div className=\"text-center text-xs text-green-600 font-medium animate-in fade-in slide-in-from-top-2 flex items-center justify-center gap-1\">\r\n                                <span className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></span>\r\n                                {publicKey?.toBase58().slice(0, 4)}...{publicKey?.toBase58().slice(-4)} connected\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"relative\">\r\n                            <div className=\"absolute inset-0 flex items-center\">\r\n                                <span className=\"w-full border-t border-border\" />\r\n                            </div>\r\n                            <div className=\"relative flex justify-center text-xs uppercase\">\r\n                                <span className=\"bg-background px-2 text-muted-foreground\">Or continue with email</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <form action={formAction} className=\"space-y-4\">\r\n                            <input type=\"hidden\" name=\"next\" value={nextUrl} />\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium mb-1.5 text-muted-foreground\">Email address</label>\r\n                                <input\r\n                                    name=\"email\"\r\n                                    type=\"email\"\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 bg-background border border-border rounded-sm focus:outline-none focus:ring-1 focus:ring-orange-500 transition-all font-mono text-sm\"\r\n                                    placeholder=\"name@example.com\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium mb-1.5 text-muted-foreground\">Password</label>\r\n                                <input\r\n                                    name=\"password\"\r\n                                    type=\"password\"\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 bg-background border border-border rounded-sm focus:outline-none focus:ring-1 focus:ring-orange-500 transition-all font-mono text-sm\"\r\n                                    placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Mode Toggle (Login vs Signup) */}\r\n                            <div className=\"flex gap-2\">\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={isPending}\r\n                                    className=\"flex-1 flex items-center justify-center gap-2 bg-orange-600 text-white py-2.5 rounded-sm hover:bg-orange-700 transition-colors font-medium shadow-sm concept-border border-transparent\"\r\n                                    onClick={() => setMode(\"login\")}\r\n                                >\r\n                                    {isPending && mode === \"login\" ? (\r\n                                        <span className=\"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                                    ) : (\r\n                                        <>\r\n                                            Sign In\r\n                                            <ArrowRight className=\"w-4 h-4\" />\r\n                                        </>\r\n                                    )}\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={isPending}\r\n                                    className=\"flex-1 flex items-center justify-center gap-2 bg-background border border-border text-foreground py-2.5 rounded-sm hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors font-medium shadow-sm\"\r\n                                    formAction={signupAction}\r\n                                    onClick={() => setMode(\"signup\")}\r\n                                >\r\n                                    {isPending && mode === \"signup\" ? (\r\n                                        <span className=\"w-5 h-5 border-2 border-gray-400/30 border-t-gray-400 rounded-full animate-spin\" />\r\n                                    ) : (\r\n                                        \"Sign Up\"\r\n                                    )}\r\n                                </button>\r\n                            </div>\r\n                            {/* State handling temporarily disabled - actions redirect on success */}\r\n                            {/* {state?.error && (\r\n                                <p className=\"text-red-500 text-sm text-center\">{state.error}</p>\r\n                            )}\r\n                            {signupState?.success && (\r\n                                <p className=\"text-green-500 text-sm text-center\">{signupState.success}</p>\r\n                            )}\r\n                            {signupState?.error && (\r\n                                <p className=\"text-red-500 text-sm text-center\">{signupState.error}</p>\r\n                            )} */}\r\n                        </form>\r\n                    </div>\r\n\r\n                    <p className=\"px-8 text-center text-sm text-muted-foreground\">\r\n                        By clicking continue, you agree to our{\" \"}\r\n                        <a href=\"#\" className=\"underline underline-offset-4 hover:text-primary\">\r\n                            Terms of Service\r\n                        </a>{\" \"}\r\n                        and{\" \"}\r\n                        <a href=\"#\" className=\"underline underline-offset-4 hover:text-primary\">\r\n                            Privacy Policy\r\n                        </a>\r\n                        .\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function AuthPage() {\r\n    return (\r\n        <Suspense fallback={\r\n            <div className=\"min-h-screen grid grid-cols-1 lg:grid-cols-2 bg-background text-foreground\">\r\n                <div className=\"hidden lg:flex flex-col justify-between p-12 bg-gray-50 dark:bg-zinc-900 border-r border-border relative overflow-hidden\">\r\n                    <div className=\"absolute inset-0 bg-gray-100/50 animate-pulse\" />\r\n                </div>\r\n                <div className=\"flex items-center justify-center p-8\">\r\n                    <div className=\"w-10 h-10 border-4 border-orange-500 border-t-transparent rounded-full animate-spin\" />\r\n                </div>\r\n            </div>\r\n        }>\r\n            <AuthPageContent />\r\n        </Suspense>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\dashboard\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\error.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":23,"column":81,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[738,870],"text":"\r\n                    The system encountered an unexpected architecting error. Don&apos;t worry, your progress is safe.\r\n                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[738,870],"text":"\r\n                    The system encountered an unexpected architecting error. Don&lsquo;t worry, your progress is safe.\r\n                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[738,870],"text":"\r\n                    The system encountered an unexpected architecting error. Don&#39;t worry, your progress is safe.\r\n                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[738,870],"text":"\r\n                    The system encountered an unexpected architecting error. Don&rsquo;t worry, your progress is safe.\r\n                "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function Error({\r\n    error,\r\n    reset,\r\n}: {\r\n    error: Error & { digest?: string };\r\n    reset: () => void;\r\n}) {\r\n    useEffect(() => {\r\n        // Log the error to an error reporting service\r\n        console.error(error);\r\n    }, [error]);\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex flex-col items-center justify-center bg-background p-6 text-center\">\r\n            <div className=\"concept-border p-8 rounded-2xl bg-muted/20 backdrop-blur-md max-w-md w-full\">\r\n                <h2 className=\"text-2xl font-bold font-heading mb-4\">Something went wrong!</h2>\r\n                <p className=\"text-muted-foreground mb-8\">\r\n                    The system encountered an unexpected architecting error. Don't worry, your progress is safe.\r\n                </p>\r\n                <div className=\"flex flex-col gap-3\">\r\n                    <button\r\n                        onClick={() => reset()}\r\n                        className=\"w-full py-3 bg-foreground text-background rounded-lg font-medium hover:opacity-90 transition-all font-mono text-sm\"\r\n                    >\r\n                        RETRY_SYSTEM_INIT()\r\n                    </button>\r\n                    <Link\r\n                        href=\"/\"\r\n                        className=\"w-full py-3 border border-border rounded-lg font-medium hover:bg-muted transition-all font-mono text-sm\"\r\n                    >\r\n                        RETURN_TO_DASHBOARD\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\not-found.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":10,"column":39,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you&apos;re looking for doesn't exist in this roadmap.\r\n                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you&lsquo;re looking for doesn't exist in this roadmap.\r\n                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you&#39;re looking for doesn't exist in this roadmap.\r\n                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you&rsquo;re looking for doesn't exist in this roadmap.\r\n                "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":10,"column":60,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you're looking for doesn&apos;t exist in this roadmap.\r\n                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you're looking for doesn&lsquo;t exist in this roadmap.\r\n                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you're looking for doesn&#39;t exist in this roadmap.\r\n                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[565,669],"text":"\r\n                    The coordinate you're looking for doesn&rsquo;t exist in this roadmap.\r\n                "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Link from \"next/link\";\r\n\r\nexport default function NotFound() {\r\n    return (\r\n        <div className=\"min-h-screen flex flex-col items-center justify-center bg-background p-6 text-center\">\r\n            <div className=\"concept-border p-8 rounded-2xl bg-muted/20 backdrop-blur-md max-w-sm w-full\">\r\n                <h2 className=\"text-4xl font-bold font-heading mb-2\">404</h2>\r\n                <p className=\"text-sm font-mono text-orange-500 mb-4 tracking-widest uppercase\">Node Not Found</p>\r\n                <p className=\"text-muted-foreground mb-8 text-sm\">\r\n                    The coordinate you're looking for doesn't exist in this roadmap.\r\n                </p>\r\n                <Link\r\n                    href=\"/\"\r\n                    className=\"inline-block w-full py-3 bg-foreground text-background rounded-lg font-medium hover:opacity-90 transition-all font-mono text-sm\"\r\n                >\r\n                    RESET_POSITION\r\n                </Link>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\onboarding\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'STAGES' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"STAGES"},"fix":{"range":[274,281],"text":""},"desc":"Remove unused variable \"STAGES\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":36,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3810,3813],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3810,3813],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\onboarding\\page.tsx:114:13\n  112 |         if (storedIdea && storedStage && !hasStartedRef.current) {\n  113 |             hasStartedRef.current = true;\n> 114 |             setIdea(storedIdea);\n      |             ^^^^^^^ Avoid calling setState() directly within an effect\n  115 |             setIsFinalizing(true);\n  116 |             completeOnboarding(storedStage);\n  117 |             return;","line":114,"column":13,"nodeType":null,"endLine":114,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'completeOnboarding'. Either include it or remove the dependency array.","line":130,"column":8,"nodeType":"ArrayExpression","endLine":130,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [completeOnboarding, sendMessage]","fix":{"range":[5047,5060],"text":"[completeOnboarding, sendMessage]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState, useRef } from \"react\";\r\nimport { ArrowUp, Sparkles } from \"lucide-react\";\r\nimport { useChat } from \"@ai-sdk/react\";\r\nimport { getTextFromMessageParts } from \"@/utils/ai\";\r\nimport { STAGES, StartupStage } from \"@/lib/stages\";\r\nimport { createProject } from \"@/actions/create-project\";\r\nimport { RotatingStatus } from \"@/components/ui/RotatingStatus\";\r\n\r\n\r\n\r\nexport default function OnboardingPage() {\r\n    const router = useRouter();\r\n    const [idea, setIdea] = useState<string | null>(null);\r\n    const [isFinalizing, setIsFinalizing] = useState(false);\r\n    const hasStartedRef = useRef(false);\r\n\r\n    // We use Vercel AI SDK's useChat hook\r\n    // Stable configuration for the hook\r\n    const { messages, sendMessage, status } = useChat({\r\n        id: \"onboarding-chat\",\r\n        onFinish: ({ message }) => {\r\n            // Check if the AI decided the stage (hidden JSON block)\r\n            try {\r\n                const content = getTextFromMessageParts(message);\r\n                if (!content) return;\r\n\r\n                const match = content.match(/\\{[\\s\\S]*?\"stage\":\\s*\"(validation|build|growth)\"[\\s\\S]*?\\}/);\r\n                if (match) {\r\n                    const jsonStr = match[0];\r\n                    const data = JSON.parse(jsonStr);\r\n                    completeOnboarding(data.stage);\r\n                }\r\n            } catch (e) {\r\n                // Not a JSON decision yet\r\n            }\r\n        }\r\n    });\r\n\r\n    const isLoading = status === \"streaming\" || status === \"submitted\" || isFinalizing;\r\n    const [input, setInput] = useState(\"\");\r\n\r\n    const handleCustomSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!input.trim() || isLoading) return;\r\n\r\n        // Pass context via sendMessage options\r\n        await sendMessage(\r\n            { parts: [{ type: \"text\", text: input }] },\r\n            { body: { mode: \"onboarding\", context: { idea } } }\r\n        );\r\n        setInput(\"\");\r\n    };\r\n\r\n    const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n    useEffect(() => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    }, [messages]);\r\n\r\n    const completeOnboarding = async (stage: string) => {\r\n        const validStage = (stage === \"validation\" || stage === \"build\" || stage === \"growth\")\r\n            ? stage as StartupStage\r\n            : \"validation\";\r\n\r\n        // Save stage for potential resume after auth redirect\r\n        localStorage.setItem(\"piely_startup_stage\", validStage);\r\n\r\n        // Save chat history for resume (in case of auth redirect)\r\n        if (messages.length > 0) {\r\n            localStorage.setItem(\"piely_onboarding_messages\", JSON.stringify(messages));\r\n        }\r\n\r\n        // Prepare messages for server: Use current state OR stored state (for rescue flow)\r\n        let messagesToSend = messages;\r\n        if (messages.length === 0) {\r\n            const storedMessages = localStorage.getItem(\"piely_onboarding_messages\");\r\n            if (storedMessages) {\r\n                try {\r\n                    messagesToSend = JSON.parse(storedMessages);\r\n                } catch (e) {\r\n                    console.error(\"Failed to parse stored messages\", e);\r\n                }\r\n            }\r\n        }\r\n\r\n        try {\r\n            const project = await createProject(idea || \"Untitled\", validStage, messagesToSend);\r\n            if (project?.id) {\r\n                // Successful creation! Clear state and move to project\r\n                localStorage.removeItem(\"piely_startup_stage\");\r\n                localStorage.removeItem(\"piely_onboarding_messages\"); // Clean up messages as they are now in DB\r\n                router.push(`/project/${project.id}`);\r\n            }\r\n        } catch (e: any) {\r\n            console.error(\"Project creation failed:\", e);\r\n\r\n            if (e.message?.includes(\"Authentication required\")) {\r\n                // Rescue flow: User is not logged in.\r\n                // localStorage is already set, so we can redirect to auth\r\n                router.push(\"/auth?intent=onboarding_complete\");\r\n            }\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        const storedIdea = localStorage.getItem(\"piely_startup_idea\");\r\n        const storedStage = localStorage.getItem(\"piely_startup_stage\");\r\n\r\n        if (storedIdea && storedStage && !hasStartedRef.current) {\r\n            hasStartedRef.current = true;\r\n            setIdea(storedIdea);\r\n            setIsFinalizing(true);\r\n            completeOnboarding(storedStage);\r\n            return;\r\n        }\r\n\r\n        if (storedIdea && !hasStartedRef.current) {\r\n            hasStartedRef.current = true;\r\n            setIdea(storedIdea);\r\n\r\n            // Initial message with context\r\n            sendMessage(\r\n                { parts: [{ type: \"text\", text: `I want to build: ${storedIdea}. Help me scope this project.` }] },\r\n                { body: { mode: \"onboarding\", context: { idea: storedIdea } } }\r\n            );\r\n        }\r\n    }, [sendMessage]);\r\n\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex flex-col bg-background text-foreground max-w-2xl mx-auto px-6 py-12\">\r\n\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between mb-12 border-b border-border pb-4\">\r\n                <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n                    <Sparkles className=\"w-4 h-4\" />\r\n                    <span className=\"text-sm font-mono uppercase tracking-wider\">AI Architect</span>\r\n                </div>\r\n                <div className=\"text-xs font-mono text-muted-foreground\">\r\n                    {idea ? `Project: ${idea.substring(0, 20)}...` : \"New Project\"}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Finalizing Overlay */}\r\n            {isFinalizing && (\r\n                <div className=\"flex-1 flex flex-col items-center justify-center space-y-4 animate-in fade-in duration-500\">\r\n                    <div className=\"p-8 bg-gray-50 dark:bg-zinc-900 border border-border rounded-xl shadow-sm\">\r\n                        <RotatingStatus />\r\n                    </div>\r\n                    <p className=\"text-sm text-muted-foreground font-mono\">Finalizing your technical blueprint...</p>\r\n                </div>\r\n            )}\r\n\r\n            {!isFinalizing && (\r\n                <>\r\n                    {/* Chat Area */}\r\n                    <div className=\"flex-1 space-y-6 mb-8\">\r\n                        {messages.filter((m) => m.role !== 'system').map((m) => {\r\n                            const textContent = getTextFromMessageParts(m);\r\n                            const isJson = /\\{[\\s\\S]*?\"stage\":\\s*\"(validation|build|growth)\"[\\s\\S]*?\\}/.test(textContent);\r\n                            const cleanText = textContent.replace(/\\{[\\s\\S]*?\"stage\":\\s*\"(validation|build|growth)\"[\\s\\S]*?\\}/g, \"\").trim();\r\n\r\n                            if (isJson && !cleanText) {\r\n                                return (\r\n                                    <div key={m.id} className=\"flex justify-start\">\r\n                                        <div className=\"bg-gray-50 dark:bg-zinc-900 border border-border px-4 py-3 rounded-lg\">\r\n                                            <RotatingStatus />\r\n                                        </div>\r\n                                    </div>\r\n                                );\r\n                            }\r\n\r\n                            return (\r\n                                <div\r\n                                    key={m.id}\r\n                                    className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}\r\n                                >\r\n                                    <div\r\n                                        className={`\r\n                    max-w-[80%] rounded-lg px-4 py-3 text-sm leading-relaxed\r\n                    ${m.role === 'user'\r\n                                                ? 'bg-foreground text-background'\r\n                                                : 'bg-gray-50 dark:bg-zinc-900 border border-border text-foreground'\r\n                                            }\r\n                  `}\r\n                                    >\r\n                                        {cleanText}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                        {status === \"streaming\" && (\r\n                            <div className=\"flex justify-start\">\r\n                                <div className=\"bg-gray-50 dark:bg-zinc-900 border border-border px-4 py-3 rounded-lg\">\r\n                                    <RotatingStatus />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                        <div ref={messagesEndRef} />\r\n                    </div>\r\n\r\n                    {/* Input Area */}\r\n                    <form onSubmit={handleCustomSubmit} className=\"relative group sticky bottom-12 pt-4 bg-background/80 backdrop-blur-sm\">\r\n                        <div className=\"absolute -inset-0.5 rounded-lg bg-gradient-to-r from-orange-500 to-blue-600 opacity-0 group-focus-within:opacity-20 transition duration-300 blur\" />\r\n                        <div className=\"relative flex items-center bg-background border border-border rounded-lg shadow-sm\">\r\n                            <input\r\n                                className=\"flex-1 bg-transparent px-4 py-3 outline-none text-sm font-medium\"\r\n                                placeholder=\"Type your answer...\"\r\n                                value={input}\r\n                                onChange={(e) => setInput(e.target.value)}\r\n                                disabled={isLoading}\r\n                                autoFocus\r\n                            />\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={!input.trim() || isLoading}\r\n                                className=\"mr-2 p-2 rounded-md bg-gray-100 hover:bg-gray-200 dark:bg-zinc-800 dark:hover:bg-zinc-700 text-foreground transition-colors disabled:opacity-50\"\r\n                            >\r\n                                <ArrowUp className=\"w-4 h-4\" />\r\n                            </button>\r\n                        </div>\r\n                        <p className=\"text-[10px] text-center text-muted-foreground mt-4 font-mono uppercase tracking-tighter italic\">\r\n                            The Architect is calculating...\r\n                        </p>\r\n                    </form>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\app\\project\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2227,2230],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2227,2230],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3209,3212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3209,3212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from \"@/utils/supabase/server\";\r\nimport { RoadmapCanvas } from \"@/components/RoadmapCanvas\";\r\nimport { STAGES, StartupStage } from \"@/lib/stages\";\r\nimport type { RoadmapResponse, RoadmapItem, RoadmapStage, RoadmapEdge } from \"@/lib/roadmapTypes\";\r\nimport { redirect } from \"next/navigation\";\r\nimport { Database } from \"@/lib/database.types\";\r\nimport { AppHeader } from \"@/components/layout/AppHeader\";\r\n\r\ninterface ProjectPageProps {\r\n    params: Promise<{ id: string }>;\r\n}\r\n\r\nexport default async function ProjectPage({ params }: ProjectPageProps) {\r\n    const { id } = await params;\r\n    const supabase = await createClient<Database>();\r\n\r\n    const { data: { user } } = await supabase.auth.getUser();\r\n    if (!user) {\r\n        redirect(\"/auth\");\r\n    }\r\n\r\n    // 1. Fetch Project Data\r\n    const { data: roadmap, error: roadmapError } = await supabase\r\n        .from(\"roadmaps\")\r\n        .select(\"*\")\r\n        .eq(\"id\", id)\r\n        .single();\r\n\r\n    if (roadmapError || !roadmap) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center bg-background text-foreground\">\r\n                <div className=\"text-center\">\r\n                    <h1 className=\"text-2xl font-bold mb-2\">Project Not Found</h1>\r\n                    <p className=\"text-muted-foreground\">The blueprint you are looking for does not exist.</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // 2. Fetch Nodes & Edges\r\n    const { data: nodes } = await supabase\r\n        .from(\"roadmap_nodes\")\r\n        .select(\"*\")\r\n        .eq(\"roadmap_id\", id)\r\n        .order(\"order_index\", { ascending: true });\r\n\r\n    const { data: edges } = await supabase\r\n        .from(\"roadmap_edges\")\r\n        .select(\"*\")\r\n        .eq(\"roadmap_id\", id);\r\n\r\n    // 3. Transform to RoadmapResponse\r\n    const stages: RoadmapStage[] = [\r\n        { ...STAGES.validation, stageOrder: 1, name: STAGES.validation.label },\r\n        { ...STAGES.build, stageOrder: 2, name: STAGES.build.label },\r\n        { ...STAGES.growth, stageOrder: 3, name: STAGES.growth.label },\r\n    ];\r\n\r\n    const items: RoadmapItem[] = (nodes || []).map((node) => {\r\n        const metadata = node.metadata as Record<string, any> | null;\r\n        return {\r\n            id: node.id,\r\n            title: node.title,\r\n            description: node.description || \"\",\r\n            // Fallback to validation if stageId is missing (legacy nodes)\r\n            stageId: metadata?.stageId || \"validation\",\r\n            category: \"product\",\r\n            difficulty: \"medium\",\r\n            impact: \"high\",\r\n            dependencies: [],\r\n            status: node.status as RoadmapItem[\"status\"],\r\n            metadata: metadata as RoadmapItem[\"metadata\"],\r\n        };\r\n    });\r\n\r\n    const roadmapData: RoadmapResponse = {\r\n        stages,\r\n        items,\r\n        edges: (edges || []).map((e): RoadmapEdge => ({\r\n            id: e.id,\r\n            from: e.from_node_id || \"\",\r\n            to: e.to_node_id || \"\",\r\n            type: e.type as RoadmapEdge[\"type\"],\r\n        })),\r\n    };\r\n\r\n\r\n    const coreNode = nodes?.find(n => n.order_index === 0);\r\n    const initialMessages = (coreNode?.metadata as Record<string, any> | null)?.messages || [];\r\n\r\n\r\n\r\n    // ... existing code ...\r\n\r\n    return (\r\n        <div className=\"h-screen w-screen overflow-hidden bg-background relative\">\r\n            <AppHeader\r\n                user={user}\r\n                variant=\"overlay\"\r\n                className=\"absolute top-0 left-0 w-full\"\r\n                breadcrumb={{\r\n                    title: roadmap.title || \"Untitled Project\"\r\n                }}\r\n            />\r\n            <RoadmapCanvas\r\n                initialRoadmap={roadmapData}\r\n                projectId={id}\r\n                projectIdea={roadmap.idea_description || roadmap.title}\r\n                initialMessages={initialMessages}\r\n                currentStage={(roadmap.stage as StartupStage) || \"validation\"}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\CanvasControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ChatInterface.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageCircle' is defined but never used.","line":4,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MessageCircle"},"fix":{"range":[106,121],"text":""},"desc":"Remove unused variable \"MessageCircle\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[559,562],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[559,562],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'roadmap' is defined but never used.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onRoadmapUpdate' is defined but never used.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onAction' is defined but never used.","line":33,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'initialMessages' is assigned a value but never used.","line":34,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useRef, useTransition } from \"react\";\nimport { Sparkles, Plus, MessageCircle, X } from \"lucide-react\";\nimport { createAINode, AINodeData } from \"@/actions/create-ai-node\";\nimport { RoadmapResponse } from \"@/lib/roadmapTypes\";\n\ninterface ChatInterfaceProps {\n  idea: string;\n  roadmap: RoadmapResponse | null;\n  projectId: string;\n  currentStage?: string;\n  onNodeCreated?: (nodeId: string) => void;\n  onRoadmapUpdate?: (roadmap: RoadmapResponse) => void;\n  onAction?: (action: string) => void;\n  initialMessages?: any[];\n}\n\ninterface ChatMessage {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  nodeCreated?: boolean;\n}\n\nexport function ChatInterface({\n  idea,\n  roadmap,\n  projectId,\n  currentStage = \"validation\",\n  onNodeCreated,\n  onRoadmapUpdate,\n  onAction,\n  initialMessages = [],\n}: ChatInterfaceProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [input, setInput] = useState(\"\");\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isPending, startTransition] = useTransition();\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n\n  useEffect(() => {\n    if (isOpen && messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n    }\n  }, [messages, isOpen]);\n\n  useEffect(() => {\n    if (isOpen && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [isOpen]);\n\n  const handleSend = async () => {\n    if (!input.trim() || isLoading) return;\n\n    const userMessage: ChatMessage = {\n      id: `user-${Date.now()}`,\n      role: \"user\",\n      content: input.trim(),\n    };\n\n    setMessages((prev) => [...prev, userMessage]);\n    setInput(\"\");\n    setIsLoading(true);\n\n    try {\n      // Call the canvas mode API\n      const response = await fetch(\"/api/chat\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          mode: \"canvas\",\n          messages: [{ role: \"user\", content: userMessage.content }],\n          context: { idea, stage: currentStage },\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to get AI response\");\n      }\n\n      const result = await response.json();\n\n      // If AI decided to create a node\n      if (result.shouldCreateNode && result.node !== null) {\n        const nodeData: AINodeData = {\n          title: result.node.title,\n          description: result.node.description,\n          type: result.node.type,\n          stageId: currentStage,\n        };\n\n        // Create the node via server action\n        startTransition(async () => {\n          const createResult = await createAINode(projectId, nodeData);\n\n          if (createResult.success && createResult.nodeId) {\n            onNodeCreated?.(createResult.nodeId);\n\n            // Add success message with node creation indicator\n            const successMessage: ChatMessage = {\n              id: `assistant-${Date.now()}`,\n              role: \"assistant\",\n              content: `âœ¨ **${result.node.title}** added to canvas!\\n\\n${result.confirmation}`,\n              nodeCreated: true,\n            };\n            setMessages((prev) => [...prev, successMessage]);\n          } else {\n            // Node creation failed\n            const errorMessage: ChatMessage = {\n              id: `assistant-${Date.now()}`,\n              role: \"assistant\",\n              content: `I tried to create \"${result.node.title}\" but encountered an error. ${result.confirmation}`,\n            };\n            setMessages((prev) => [...prev, errorMessage]);\n          }\n        });\n      } else {\n        // Just a regular response, no node created\n        const assistantMessage: ChatMessage = {\n          id: `assistant-${Date.now()}`,\n          role: \"assistant\",\n          content: result.confirmation,\n        };\n        setMessages((prev) => [...prev, assistantMessage]);\n      }\n    } catch (error) {\n      console.error(\"Chat error:\", error);\n      const errorMessage: ChatMessage = {\n        id: `error-${Date.now()}`,\n        role: \"assistant\",\n        content: \"Sorry, I encountered an error. Please try again.\",\n      };\n      setMessages((prev) => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  function handleKeyDown(e: React.KeyboardEvent<HTMLTextAreaElement>) {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  }\n\n  const isProcessing = isLoading || isPending;\n\n  return (\n    <>\n      {/* Floating Action Button */}\n      {!isOpen && (\n        <button\n          onClick={() => setIsOpen(true)}\n          className=\"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-2 rounded-full bg-gradient-to-r from-orange-500 to-orange-600 px-5 py-3 text-sm font-medium text-white shadow-lg transition hover:shadow-xl hover:scale-105 active:scale-95\"\n        >\n          <Plus className=\"h-5 w-5\" />\n          Add to Canvas\n        </button>\n      )}\n\n      {/* Chat Panel */}\n      {isOpen && (\n        <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 w-full max-w-2xl animate-in fade-in slide-in-from-bottom-4 duration-300\">\n          <div className=\"flex flex-col rounded-xl border border-border bg-background shadow-2xl overflow-hidden\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between px-4 py-3 border-b border-border bg-gradient-to-r from-orange-500/10 to-blue-500/10\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"h-8 w-8 rounded-full bg-gradient-to-r from-orange-500 to-blue-600 flex items-center justify-center\">\n                  <Sparkles className=\"h-4 w-4 text-white\" />\n                </div>\n                <div>\n                  <span className=\"text-sm font-medium block\">Piely Architect</span>\n                  <span className=\"text-[10px] text-muted-foreground\">Tell me what to add to your blueprint</span>\n                </div>\n              </div>\n              <button\n                onClick={() => setIsOpen(false)}\n                className=\"text-muted-foreground hover:text-foreground transition p-1 rounded-md hover:bg-muted\"\n              >\n                <X className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            {/* Messages */}\n            <div className=\"flex flex-col gap-3 p-4 h-[350px] overflow-y-auto bg-background/50 backdrop-blur-sm\">\n              {messages.length === 0 && (\n                <div className=\"flex flex-col gap-3 text-sm text-muted-foreground\">\n                  <p className=\"text-center\">\n                    Describe a feature, module, or milestone to add to your canvas.\n                  </p>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {[\n                      \"Add user authentication\",\n                      \"Build payment system\",\n                      \"Create landing page\",\n                      \"Set up analytics\",\n                    ].map((suggestion) => (\n                      <button\n                        key={suggestion}\n                        onClick={() => setInput(suggestion)}\n                        className=\"text-left px-3 py-2 rounded-lg border border-border hover:bg-muted hover:border-orange-500/50 transition-all text-xs\"\n                      >\n                        {suggestion}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {messages.map((message) => (\n                <div\n                  key={message.id}\n                  className={`flex flex-col ${message.role === \"user\" ? \"items-end\" : \"items-start\"}`}\n                >\n                  <div\n                    className={`max-w-[85%] rounded-lg px-4 py-2.5 text-sm leading-relaxed ${message.role === \"user\"\n                      ? \"bg-foreground text-background\"\n                      : message.nodeCreated\n                        ? \"bg-gradient-to-r from-orange-500/10 to-green-500/10 border border-green-500/30 text-foreground\"\n                        : \"bg-muted border border-border text-foreground\"\n                      }`}\n                  >\n                    {message.content}\n                  </div>\n                  {message.nodeCreated && (\n                    <span className=\"text-[10px] text-green-600 mt-1 flex items-center gap-1\">\n                      <span className=\"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse\" />\n                      Node added to canvas\n                    </span>\n                  )}\n                </div>\n              ))}\n\n              {isProcessing && (\n                <div className=\"flex justify-start\">\n                  <div className=\"bg-muted border border-border text-foreground rounded-lg px-4 py-3 text-sm flex items-center gap-2\">\n                    <Sparkles className=\"h-4 w-4 text-orange-500 animate-spin\" />\n                    <span className=\"text-muted-foreground\">Creating node...</span>\n                  </div>\n                </div>\n              )}\n\n              <div ref={messagesEndRef} />\n            </div>\n\n            {/* Input */}\n            <div className=\"border-t border-border p-3 bg-muted/20\">\n              <div className=\"flex gap-2\">\n                <textarea\n                  ref={inputRef}\n                  value={input}\n                  onChange={(e) => setInput(e.target.value)}\n                  onKeyDown={handleKeyDown}\n                  placeholder=\"Add user authentication, payment flow, analytics...\"\n                  className=\"flex-1 rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-orange-500/50 resize-none transition-all\"\n                  rows={1}\n                  disabled={isProcessing}\n                />\n                <button\n                  onClick={handleSend}\n                  disabled={!input.trim() || isProcessing}\n                  className=\"rounded-lg bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-2 text-sm font-medium text-white transition hover:opacity-90 disabled:cursor-not-allowed disabled:opacity-50 flex items-center gap-2\"\n                >\n                  <Plus className=\"h-4 w-4\" />\n                  Add\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\NodeDetailsPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\RoadmapCanvas.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":3,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useCallback"},"fix":{"range":[49,62],"text":""},"desc":"Remove unused variable \"useCallback\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Layout' is defined but never used.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Layout"},"fix":{"range":[284,322],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1198,1201],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1198,1201],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1666,1669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1666,1669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3868,3871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3868,3871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":169,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5707,5710],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5707,5710],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'getNodeStatus'. Either include it or remove the dependency array.","line":174,"column":6,"nodeType":"ArrayExpression","endLine":174,"endColumn":77,"suggestions":[{"desc":"Update the dependencies array to be: [initialRoadmap, viewMode, filteredItems, getNodeStatus, completedItems]","fix":{"range":[5861,5932],"text":"[initialRoadmap, viewMode, filteredItems, getNodeStatus, completedItems]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":223,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7545,7548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7545,7548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'setEdges'. Either include it or remove the dependency array.","line":300,"column":6,"nodeType":"ArrayExpression","endLine":300,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [projectId, setEdges, setNodes]","fix":{"range":[10190,10211],"text":"[projectId, setEdges, setNodes]"}}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useMemo, useEffect, useCallback } from \"react\";\nimport ReactFlow, {\n  Background,\n  Controls,\n  MiniMap,\n  ReactFlowProvider,\n  useEdgesState,\n  useNodesState,\n  Node,\n  BackgroundVariant,\n  Panel,\n} from \"reactflow\";\nimport \"reactflow/dist/style.css\";\nimport { Layout } from \"lucide-react\"; // Icon for toggle\n\nimport { NodeDrawer } from \"@/components/canvas/NodeDrawer\";\nimport type { RoadmapResponse, RoadmapStage, RoadmapItem, RoadmapNodeData, NodeStatus } from \"@/lib/roadmapTypes\";\nimport { calculateLayout, applyLayoutHints } from \"@/lib/layoutEngine\";\nimport { TechnicalNode } from \"@/components/canvas/TechnicalNode\";\nimport { GhostNode } from \"@/components/canvas/GhostNode\";\nimport { AcceleratorTrack } from \"@/components/canvas/AcceleratorTrack\";\nimport { OSNode } from \"@/components/canvas/OSNode\";\nimport type { StartupStage } from \"@/lib/stages\";\n\nimport { ChatInterface } from \"@/components/ChatInterface\";\nimport { createClient } from \"@/utils/supabase/client\";\nimport { Database } from \"@/lib/database.types\";\n\ninterface RoadmapCanvasProps {\n  initialRoadmap: RoadmapResponse | null;\n  projectId: string;\n  projectIdea?: string;\n  initialMessages?: any[];\n  currentStage?: StartupStage;\n  onSelectStage?: (stageId: string) => void;\n  onSelectNode?: (node: RoadmapStage | RoadmapItem | null) => void;\n  selectedCategories?: Set<string>;\n  searchQuery?: string;\n  completedItems?: Set<string>;\n  onToggleComplete?: (itemId: string) => void;\n}\n\nconst nodeTypes = {\n  technical: TechnicalNode,\n  ghost: GhostNode,\n  os_module: OSNode,\n  default: TechnicalNode,\n};\n\nconst EMPTY_SET = new Set<string>();\nconst EMPTY_ARRAY: any[] = [];\n\nfunction RoadmapCanvasInner({\n  // ... props\n  initialRoadmap,\n  projectId,\n  projectIdea = \"Startup Idea\",\n  initialMessages = EMPTY_ARRAY,\n  currentStage = \"validation\",\n  onSelectStage,\n  onSelectNode,\n  selectedCategories = EMPTY_SET,\n  searchQuery = \"\",\n  completedItems = EMPTY_SET,\n  onToggleComplete,\n}: RoadmapCanvasProps) {\n  // State for View Mode\n  const [viewMode, setViewMode] = React.useState<\"campus\" | \"blueprint\">(\"campus\");\n  const [isAnalyzing, setIsAnalyzing] = React.useState(false);\n  const [selectedNode, setSelectedNode] = React.useState<RoadmapItem | RoadmapStage | null>(null);\n\n  const filteredItems = useMemo(() => {\n    if (!initialRoadmap) return [];\n    return initialRoadmap.items.filter((item) => {\n      // Category filter\n      if (selectedCategories.size > 0 && !selectedCategories.has(item.category)) {\n        return false;\n      }\n      // Search filter\n      if (searchQuery) {\n        const query = searchQuery.toLowerCase();\n        return (\n          item.title.toLowerCase().includes(query) ||\n          item.description.toLowerCase().includes(query)\n        );\n      }\n      return true;\n    });\n  }, [initialRoadmap, selectedCategories, searchQuery]);\n\n  // Stage order for comparison\n  const STAGE_ORDER: Record<string, number> = {\n    validation: 1,\n    build: 2,\n    growth: 3,\n  };\n  const currentStageOrder = STAGE_ORDER[currentStage] || 1;\n\n  // Helper to determine node status based on stage comparison\n  const getNodeStatus = (nodeStageId: string, isCompleted: boolean): NodeStatus => {\n    const nodeStageOrder = STAGE_ORDER[nodeStageId] || 1;\n\n    if (isCompleted) return \"completed\";\n    if (nodeStageOrder < currentStageOrder) return \"completed\"; // Past stages\n    if (nodeStageOrder === currentStageOrder) return \"active\";  // Current stage\n    return \"projected\"; // Future stages\n  };\n\n  const initialNodes = useMemo(() => {\n    if (!initialRoadmap) return [];\n\n    // Calculate layout positions: \"tree\" for Blueprint, default/existing for Campus\n    const activeLayout = viewMode === \"blueprint\" ? \"tree\" : (initialRoadmap.layoutType || \"swimlanes\");\n    const basePositions = calculateLayout(initialRoadmap, activeLayout as any);\n\n    // Only apply hints (manual overrides) if we are in Campus mode. \n    // Blueprint mode enforces strict structure.\n    const positions = viewMode === \"campus\"\n      ? applyLayoutHints(basePositions, initialRoadmap)\n      : basePositions;\n\n    return [\n      // stage nodes\n      ...initialRoadmap.stages.map((stage) => {\n        const pos = positions.get(stage.id) || { x: 0, y: 0 };\n        const stageStatus = getNodeStatus(stage.id, false);\n        return {\n          id: stage.id,\n          data: {\n            label: stage.name,\n            stageId: stage.id,\n            type: \"stage\",\n            stageData: stage,\n            nodeStatus: stageStatus, // AI-driven status\n          },\n          position: {\n            x: pos.x,\n            y: pos.y,\n          },\n          type: \"technical\",\n        };\n      }),\n      // item nodes (filtered)\n      ...filteredItems.map((item) => {\n        // Prioritize persisted metadata coordinates (Visual OS) layout over auto-layout\n        const meta = item.metadata as Record<string, unknown>;\n        let pos = positions.get(item.id) || { x: 0, y: 0 };\n\n        // Only use persisted coordinates in Campus Mode\n        if (viewMode === \"campus\" && meta?.x !== undefined && meta?.y !== undefined) {\n          pos = { x: meta.x as number, y: meta.y as number };\n        }\n\n        const isCompleted = completedItems.has(item.id) || item.status === \"completed\";\n        const itemStatus = getNodeStatus(item.stageId, isCompleted);\n        return {\n          id: item.id,\n          data: {\n            label: item.title,\n            stageId: item.stageId,\n            type: \"item\",\n            itemData: item,\n            isCompleted,\n            nodeStatus: itemStatus, // AI-driven status\n          },\n          position: { x: pos.x, y: pos.y },\n          type: (item.metadata as any)?.type === \"os_module\" ? \"os_module\" : \"technical\",\n        };\n      }),\n      // Ghost Node (if AI is active)\n    ] as Node<RoadmapNodeData>[];\n  }, [initialRoadmap, filteredItems, completedItems, currentStage, viewMode]);\n\n  const initialEdges = useMemo(() => {\n    if (!initialRoadmap || !initialRoadmap.edges) return [];\n\n    return initialRoadmap.edges.map((edge) => {\n      // Edge styling based on type\n      const edgeStyles = {\n        depends_on: { stroke: \"#f97316\", strokeWidth: 2, animated: true },\n        precedes: { stroke: \"url(#accelerator-gradient)\", strokeWidth: 2, animated: false },\n        related: { stroke: \"#94a3b8\", strokeWidth: 1, animated: false },\n      };\n      const style = edgeStyles[edge.type] || edgeStyles.related;\n\n      return {\n        id: edge.id,\n        source: edge.from,\n        target: edge.to,\n        animated: style.animated,\n        type: \"smoothstep\",\n        style: { stroke: style.stroke, strokeWidth: style.strokeWidth },\n      };\n    });\n  }, [initialRoadmap]);\n\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);\n\n  // Sync nodes when ViewMode changes\n  useEffect(() => {\n    setNodes(initialNodes);\n  }, [initialNodes, setNodes]);\n\n  // Realtime subscription for live canvas updates\n  useEffect(() => {\n    const supabase = createClient();\n\n    const channel = supabase\n      .channel(`project-${projectId}`)\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'roadmap_nodes',\n          filter: `roadmap_id=eq.${projectId}`,\n        },\n        (payload) => {\n          const newRow = payload.new as Database[\"public\"][\"Tables\"][\"roadmap_nodes\"][\"Row\"];\n          const metadata = newRow.metadata as Record<string, any> | null;\n\n          // Create ReactFlow node from database row\n          const newNode: Node<RoadmapNodeData> = {\n            id: newRow.id,\n            type: metadata?.type === \"os_module\" ? \"os_module\" : \"technical\",\n            position: {\n              x: (metadata?.x as number) ?? 400,\n              y: (metadata?.y as number) ?? 200,\n            },\n            data: {\n              label: newRow.title,\n              stageId: metadata?.stageId || 'validation',\n              type: 'item',\n              itemData: {\n                id: newRow.id,\n                title: newRow.title,\n                description: newRow.description || '',\n                stageId: metadata?.stageId || 'validation',\n                category: metadata?.category || 'product',\n                difficulty: 'medium',\n                impact: 'high',\n                dependencies: [],\n                status: newRow.status as RoadmapItem[\"status\"],\n              },\n              nodeStatus: 'active',\n            },\n          };\n\n          setNodes((nds) => [...nds, newNode]);\n        }\n      )\n      .subscribe();\n\n    // Separate channel for Edges (or could be same channel, different listener)\n    const edgeChannel = supabase\n      .channel(`project-edges-${projectId}`)\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'roadmap_edges',\n          filter: `roadmap_id=eq.${projectId}`,\n        },\n        (payload) => {\n          const newEdgeRow = payload.new as Database[\"public\"][\"Tables\"][\"roadmap_edges\"][\"Row\"];\n\n          if (!newEdgeRow.from_node_id || !newEdgeRow.to_node_id) return;\n\n          const edgeStyles = {\n            depends_on: { stroke: \"#f97316\", strokeWidth: 2, animated: true },\n            precedes: { stroke: \"url(#accelerator-gradient)\", strokeWidth: 2, animated: false },\n            related: { stroke: \"#94a3b8\", strokeWidth: 1, animated: false },\n          };\n          const edgeType = (newEdgeRow.type as keyof typeof edgeStyles) || \"related\";\n          const style = edgeStyles[edgeType] || edgeStyles.related;\n\n          const newEdge = {\n            id: newEdgeRow.id,\n            source: newEdgeRow.from_node_id,\n            target: newEdgeRow.to_node_id,\n            animated: style.animated,\n            type: \"smoothstep\",\n            style: { stroke: style.stroke, strokeWidth: style.strokeWidth },\n          };\n\n          setEdges((eds) => [...eds, newEdge]);\n        }\n      )\n      .subscribe();\n\n    // Cleanup on unmount\n    return () => {\n      supabase.removeChannel(channel);\n      supabase.removeChannel(edgeChannel);\n    };\n  }, [projectId, setNodes]);\n\n  function handleNodeClick(e: React.MouseEvent, node: Node) {\n    if (!initialRoadmap) return;\n\n    const nodeData = node.data;\n    if (nodeData?.type === \"stage\") {\n      const stage = initialRoadmap.stages.find((s) => s.id === nodeData.stageId);\n      if (stage) {\n        setSelectedNode(stage); // Open Drawer\n        onSelectNode?.(stage);\n        if (onSelectStage) {\n          onSelectStage(stage.id);\n        }\n      }\n    } else if (nodeData?.type === \"item\") {\n      const item = initialRoadmap.items.find((i) => i.id === node.id);\n      if (item) {\n        // Double-click to toggle completion\n        if (e.detail === 2 && onToggleComplete) {\n          onToggleComplete(item.id);\n        } else {\n          setSelectedNode(item); // Open Drawer\n          onSelectNode?.(item);\n        }\n      }\n    }\n  }\n\n  return (\n    <div className={`h-full w-full relative transition-colors duration-500 ${viewMode === \"blueprint\"\n      ? \"theme-blueprint bg-[#101420]\"\n      : \"bg-gray-50 dark:bg-[#111]\"\n      }`}>\n      {/* Accelerator Progress Track */}\n      <AcceleratorTrack currentStage={currentStage} />\n\n      {/* Shared Definitions for Edge Gradients */}\n      <svg style={{ position: 'absolute', top: 0, left: 0, width: 0, height: 0, pointerEvents: 'none' }}>\n        <defs>\n          <linearGradient id=\"accelerator-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n            <stop offset=\"0%\" stopColor=\"#f59e0b\" />  {/* Amber (HQ) */}\n            <stop offset=\"50%\" stopColor=\"#8b5cf6\" />  {/* Violet (Product) */}\n            <stop offset=\"100%\" stopColor=\"#10b981\" /> {/* Emerald (GTM) */}\n          </linearGradient>\n        </defs>\n      </svg>\n\n      <ReactFlow\n        nodes={nodes}\n        edges={edges}\n        nodeTypes={nodeTypes}\n        onNodesChange={onNodesChange}\n        onEdgesChange={onEdgesChange}\n        onNodeClick={handleNodeClick}\n        onPaneClick={() => onSelectNode?.(null)}\n        fitView\n        snapToGrid={true}\n        snapGrid={[20, 20]}\n      >\n        <Background\n          variant={viewMode === \"blueprint\" ? BackgroundVariant.Lines : BackgroundVariant.Dots}\n          gap={viewMode === \"blueprint\" ? 40 : 24}\n          size={1}\n          color={viewMode === \"blueprint\" ? \"rgba(255,255,255,0.05)\" : \"#a1a1aa\"}\n          className={viewMode === \"blueprint\" ? \"\" : \"opacity-20\"}\n        />\n        <MiniMap\n          nodeColor={viewMode === \"blueprint\" ? \"#1a1f35\" : \"#e4e4e7\"}\n          maskColor={viewMode === \"blueprint\" ? \"rgba(0,0,0,0.5)\" : \"rgba(20, 20, 20, 0.05)\"}\n          className=\"!bg-background !border !border-border rounded-sm\"\n        />\n        <Controls className=\"bg-background border border-border rounded-sm shadow-sm\" />\n\n        {/* View Switcher Panel */}\n        <Panel position=\"top-right\" className=\"flex gap-2 items-center\">\n          {/* AI Consultant Button */}\n          <div className=\"bg-background/90 backdrop-blur border border-border p-1 rounded-lg shadow-sm\">\n            <button\n              onClick={async () => {\n                setIsAnalyzing(true);\n                try {\n                  const { analyzeCanvas } = await import(\"@/actions/analyze-canvas\");\n                  await analyzeCanvas(projectId);\n                } catch (err) {\n                  console.error(\"AI Analysis failed\", err);\n                } finally {\n                  setIsAnalyzing(false);\n                }\n              }}\n              disabled={isAnalyzing}\n              className={`flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-all ${isAnalyzing\n                ? \"bg-amber-100 text-amber-700 animate-pulse cursor-wait\"\n                : \"bg-amber-500 text-white hover:bg-amber-600 shadow-sm\"\n                }`}\n            >\n              {isAnalyzing ? \"ðŸ§  Thinking...\" : \"âœ¨ Consult AI\"}\n            </button>\n          </div>\n\n          {/* View Mode Toggle */}\n          <div className=\"bg-background/90 backdrop-blur border border-border p-1 rounded-lg flex gap-1 shadow-sm\">\n            <button\n              onClick={() => setViewMode(\"campus\")}\n              className={`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${viewMode === \"campus\"\n                ? \"bg-primary text-primary-foreground shadow-sm\"\n                : \"text-muted-foreground hover:bg-muted\"\n                }`}\n            >\n              ðŸ™ï¸ Campus\n            </button>\n            <button\n              onClick={() => setViewMode(\"blueprint\")}\n              className={`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${viewMode === \"blueprint\"\n                ? \"bg-blue-600 text-white shadow-sm\"\n                : \"text-muted-foreground hover:bg-muted\"\n                }`}\n            >\n              ðŸ“ Blueprint\n            </button>\n          </div>\n        </Panel>\n      </ReactFlow>\n\n      {initialRoadmap && (\n        <ChatInterface\n          idea={projectIdea}\n          roadmap={initialRoadmap}\n          projectId={projectId}\n          currentStage={currentStage}\n          initialMessages={initialMessages}\n        />\n      )}\n\n      {/* Node Context Drawer */}\n      <NodeDrawer\n        isOpen={!!selectedNode}\n        onClose={() => setSelectedNode(null)}\n        selectedNode={selectedNode}\n        projectId={projectId}\n      />\n    </div>\n  );\n}\n\nexport function RoadmapCanvas(props: RoadmapCanvasProps) {\n  return (\n    <ReactFlowProvider>\n      <RoadmapCanvasInner {...props} />\n    </ReactFlowProvider>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\AcceleratorTrack.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\GhostNode.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[499,502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[499,502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { memo } from \"react\";\r\nimport { Handle, Position } from \"reactflow\";\r\nimport { MessageSquareWarning, Lightbulb } from \"lucide-react\";\r\nimport { RoadmapNodeData } from \"@/lib/roadmapTypes\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface GhostNodeProps {\r\n    data: RoadmapNodeData;\r\n    selected?: boolean;\r\n}\r\n\r\nexport const GhostNode = memo(({ data, selected }: GhostNodeProps) => {\r\n    // Extract metadata for critique details\r\n    const meta = data.itemData?.metadata as Record<string, any> | undefined;\r\n    const severity = meta?.severity || \"suggestion\"; // \"warning\" | \"suggestion\"\r\n\r\n    // Theme: Yellow for suggestions, Red/Orange for warnings\r\n    const isWarning = severity === \"warning\";\r\n\r\n    return (\r\n        <div className={cn(\r\n            \"relative group transition-all duration-300\",\r\n            // Sticky Note Look: Slight shadow, minimal border\r\n            \"w-[240px] p-4 rounded-sm shadow-md\",\r\n            isWarning\r\n                ? \"bg-red-50 dark:bg-red-950/40 border-l-4 border-red-500 text-red-900 dark:text-red-100\"\r\n                : \"bg-yellow-50 dark:bg-yellow-950/40 border-l-4 border-yellow-500 text-yellow-900 dark:text-yellow-100\",\r\n            selected && \"ring-2 ring-primary ring-offset-2\"\r\n        )}>\r\n            {/* Header Icon */}\r\n            <div className=\"absolute -top-3 -left-3 bg-background rounded-full p-1.5 border shadow-sm\">\r\n                {isWarning ? (\r\n                    <MessageSquareWarning className=\"w-4 h-4 text-red-500\" />\r\n                ) : (\r\n                    <Lightbulb className=\"w-4 h-4 text-yellow-500\" />\r\n                )}\r\n            </div>\r\n\r\n            {/* Critique Content */}\r\n            <div className=\"mt-1\">\r\n                <h4 className=\"text-xs font-bold uppercase tracking-wider opacity-70 mb-1\">\r\n                    {data.label || \"AI Insight\"}\r\n                </h4>\r\n                <p className=\"text-sm font-medium leading-snug font-handwriting opacity-90\">\r\n                    {/* If description exists use it, otherwise label */}\r\n                    {data.itemData?.description || data.label}\r\n                </p>\r\n            </div>\r\n\r\n            {/* Connector Handles (Invisible, just for dagre/anchoring) */}\r\n            <Handle type=\"target\" position={Position.Top} className=\"!opacity-0\" />\r\n            <Handle type=\"source\" position={Position.Bottom} className=\"!opacity-0\" />\r\n        </div>\r\n    );\r\n});\r\n\r\nGhostNode.displayName = \"GhostNode\";\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\MetricBlock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\NodeActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\NodeAttachments.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadAttachments` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\NodeAttachments.tsx:29:9\n  27 |\n  28 |     useEffect(() => {\n> 29 |         loadAttachments();\n     |         ^^^^^^^^^^^^^^^ `loadAttachments` accessed before it is declared\n  30 |     }, [nodeId]);\n  31 |\n  32 |     async function loadAttachments() {\n\nC:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\NodeAttachments.tsx:32:5\n  30 |     }, [nodeId]);\n  31 |\n> 32 |     async function loadAttachments() {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 33 |         setIsLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 34 |         const data = await fetchNodeAttachments(nodeId);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 35 |         setAttachments(data);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 36 |         setIsLoading(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 37 |     }\n     | ^^^^^^ `loadAttachments` is declared here\n  38 |\n  39 |     async function handleUpload(e: React.ChangeEvent<HTMLInputElement>) {\n  40 |         const file = e.target.files?.[0];","line":29,"column":9,"nodeType":null,"endLine":29,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAttachments'. Either include it or remove the dependency array.","line":30,"column":8,"nodeType":"ArrayExpression","endLine":30,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [loadAttachments, nodeId]","fix":{"range":[941,949],"text":"[loadAttachments, nodeId]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { FileText, Upload, Trash2, ExternalLink, Loader2 } from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\nimport { uploadNodeAttachment, fetchNodeAttachments, deleteNodeAttachment } from \"@/actions/node-attachments\";\r\n\r\ninterface NodeAttachmentsProps {\r\n    nodeId: string;\r\n}\r\n\r\ninterface Attachment {\r\n    id: string;\r\n    file_name: string;\r\n    file_url: string;\r\n    file_type: string;\r\n    file_size: number;\r\n    created_at: string;\r\n}\r\n\r\nexport function NodeAttachments({ nodeId }: NodeAttachmentsProps) {\r\n    const [attachments, setAttachments] = useState<Attachment[]>([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isUploading, setIsUploading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        loadAttachments();\r\n    }, [nodeId]);\r\n\r\n    async function loadAttachments() {\r\n        setIsLoading(true);\r\n        const data = await fetchNodeAttachments(nodeId);\r\n        setAttachments(data);\r\n        setIsLoading(false);\r\n    }\r\n\r\n    async function handleUpload(e: React.ChangeEvent<HTMLInputElement>) {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        setIsUploading(true);\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n        formData.append(\"nodeId\", nodeId);\r\n\r\n        const result = await uploadNodeAttachment(formData);\r\n\r\n        if (result.error) {\r\n            toast.error(result.error);\r\n        } else {\r\n            toast.success(\"File uploaded successfully\");\r\n            loadAttachments();\r\n        }\r\n        setIsUploading(false);\r\n        // Reset input\r\n        e.target.value = \"\";\r\n    }\r\n\r\n    async function handleDelete(id: string, path: string) {\r\n        if (!confirm(\"Are you sure you want to delete this file?\")) return;\r\n\r\n        const result = await deleteNodeAttachment(id, path);\r\n        if (result.error) {\r\n            toast.error(result.error);\r\n        } else {\r\n            toast.success(\"File deleted\");\r\n            loadAttachments();\r\n        }\r\n    }\r\n\r\n    function formatSize(bytes: number) {\r\n        if (bytes === 0) return \"0 B\";\r\n        const k = 1024;\r\n        const sizes = [\"B\", \"KB\", \"MB\", \"GB\"];\r\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + \" \" + sizes[i];\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full\">\r\n            <div className=\"p-4 border-b bg-muted/20\">\r\n                <label htmlFor=\"file-upload\" className=\"cursor-pointer\">\r\n                    <div className={`flex items-center justify-center gap-2 w-full border-2 border-dashed border-muted-foreground/25 rounded-lg p-6 hover:bg-muted/50 transition-colors ${isUploading ? 'opacity-50 pointer-events-none' : ''}`}>\r\n                        {isUploading ? (\r\n                            <Loader2 className=\"w-5 h-5 animate-spin text-primary\" />\r\n                        ) : (\r\n                            <Upload className=\"w-5 h-5 text-muted-foreground\" />\r\n                        )}\r\n                        <span className=\"text-sm font-medium text-muted-foreground\">\r\n                            {isUploading ? \"Uploading...\" : \"Upload File (PDF, IMG, DOC)\"}\r\n                        </span>\r\n                        <input\r\n                            id=\"file-upload\"\r\n                            type=\"file\"\r\n                            className=\"hidden\"\r\n                            onChange={handleUpload}\r\n                            disabled={isUploading}\r\n                        />\r\n                    </div>\r\n                </label>\r\n            </div>\r\n\r\n            <ScrollArea className=\"flex-1 p-4\">\r\n                {isLoading ? (\r\n                    <div className=\"flex justify-center py-8\">\r\n                        <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\r\n                    </div>\r\n                ) : attachments.length === 0 ? (\r\n                    <div className=\"text-center py-8 text-muted-foreground text-sm\">\r\n                        No attachments yet.\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"space-y-3\">\r\n                        {attachments.map((file) => (\r\n                            <div key={file.id} className=\"flex items-center justify-between p-3 rounded-md bg-card border shadow-sm group\">\r\n                                <div className=\"flex items-center gap-3 overflow-hidden\">\r\n                                    <div className=\"w-8 h-8 rounded bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center flex-shrink-0\">\r\n                                        <FileText className=\"w-4 h-4 text-blue-600 dark:text-blue-400\" />\r\n                                    </div>\r\n                                    <div className=\"min-w-0\">\r\n                                        <p className=\"text-sm font-medium truncate\">{file.file_name}</p>\r\n                                        <p className=\"text-xs text-muted-foreground\">{formatSize(file.file_size)} â€¢ {new Date(file.created_at).toLocaleDateString()}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                    <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" asChild>\r\n                                        <a href={file.file_url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                                            <ExternalLink className=\"w-4 h-4\" />\r\n                                        </a>\r\n                                    </Button>\r\n                                    <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10\" onClick={() => handleDelete(file.id, file.file_name)}>\r\n                                        <Trash2 className=\"w-4 h-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </ScrollArea>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\NodeContextChat.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ScrollArea' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":20,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"ScrollArea"},"fix":{"range":[250,307],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AvatarImage' is defined but never used.","line":8,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":45,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AvatarImage"},"fix":{"range":[340,353],"text":""},"desc":"Remove unused variable \"AvatarImage\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":67,"column":30,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[2386,2425],"text":"\r\n                            I&apos;m your "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[2386,2425],"text":"\r\n                            I&lsquo;m your "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[2386,2425],"text":"\r\n                            I&#39;m your "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[2386,2425],"text":"\r\n                            I&rsquo;m your "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useChat, Message } from \"@ai-sdk/react\"; // Updated import based on package.json\r\nimport { useEffect, useRef } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Send, Bot, User, Loader2 } from \"lucide-react\";\r\nimport { fetchNodeChatHistory } from \"@/actions/node-chat\";\r\n\r\ninterface NodeContextChatProps {\r\n    nodeId: string;\r\n    nodeTitle: string;\r\n    nodeDescription: string;\r\n    projectId: string;\r\n}\r\n\r\nexport function NodeContextChat({ nodeId, nodeTitle, nodeDescription, projectId }: NodeContextChatProps) {\r\n    const { messages, input, handleInputChange, handleSubmit, isLoading, setMessages } = useChat({\r\n        api: \"/api/chat/node\",\r\n        body: {\r\n            nodeId,\r\n            nodeTitle,\r\n            nodeDescription,\r\n            projectId\r\n        },\r\n        onFinish: () => {\r\n            // Messages are persisted by the API route\r\n        }\r\n    });\r\n\r\n    // Load history when node changes\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n\r\n        async function loadHistory() {\r\n            setMessages([]); // Clear previous context first\r\n            const history = await fetchNodeChatHistory(nodeId);\r\n            if (isMounted && history.length > 0) {\r\n                setMessages(history);\r\n            }\r\n        }\r\n\r\n        loadHistory();\r\n\r\n        return () => { isMounted = false; };\r\n    }, [nodeId, setMessages]);\r\n\r\n    const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n        }\r\n    }, [messages]);\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full\">\r\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n                {messages.length === 0 && (\r\n                    <div className=\"text-center text-muted-foreground py-12 flex flex-col items-center gap-3\">\r\n                        <div className=\"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                            <Bot className=\"w-6 h-6 text-primary\" />\r\n                        </div>\r\n                        <div className=\"max-w-[80%] text-sm\">\r\n                            I'm your <strong>{nodeTitle}</strong> expert. Ask me to draft content, suggest strategies, or explain technical details!\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {messages.map((m: Message) => (\r\n                    <div\r\n                        key={m.id}\r\n                        className={`flex gap-3 ${m.role === \"user\" ? \"flex-row-reverse\" : \"flex-row\"\r\n                            }`}\r\n                    >\r\n                        <Avatar className=\"w-8 h-8 h-8 w-8\">\r\n                            <AvatarFallback className={m.role === 'user' ? 'bg-blue-100 text-blue-700' : 'bg-primary/10 text-primary'}>\r\n                                {m.role === \"user\" ? <User className=\"w-4 h-4\" /> : <Bot className=\"w-4 h-4\" />}\r\n                            </AvatarFallback>\r\n                        </Avatar>\r\n                        <div\r\n                            className={`rounded-lg p-3 text-sm max-w-[85%] ${m.role === \"user\"\r\n                                ? \"bg-blue-600 text-white\"\r\n                                : \"bg-muted text-foreground\"\r\n                                }`}\r\n                        >\r\n                            <div dangerouslySetInnerHTML={{ __html: m.content.replace(/\\n/g, \"<br/>\") }} />\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n                {isLoading && (\r\n                    <div className=\"flex gap-3\">\r\n                        <Avatar className=\"w-8 h-8\">\r\n                            <AvatarFallback className=\"bg-primary/10\">\r\n                                <Loader2 className=\"w-4 h-4 animate-spin text-primary\" />\r\n                            </AvatarFallback>\r\n                        </Avatar>\r\n                        <div className=\"bg-muted rounded-lg p-3 text-sm text-foreground/50 italic\">\r\n                            Thinking...\r\n                        </div>\r\n                    </div>\r\n                )}\r\n                <div ref={scrollRef} />\r\n            </div>\r\n\r\n            <div className=\"p-4 border-t bg-background\">\r\n                <form onSubmit={handleSubmit} className=\"flex gap-2\">\r\n                    <Input\r\n                        value={input}\r\n                        onChange={handleInputChange}\r\n                        placeholder={`Ask about ${nodeTitle}...`}\r\n                        className=\"flex-1\"\r\n                    />\r\n                    <Button type=\"submit\" size=\"icon\" disabled={isLoading || !(input || \"\").trim()}>\r\n                        <Send className=\"w-4 h-4\" />\r\n                    </Button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\NodeDrawer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[290,338],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[349,351],"text":""},"desc":"Remove unused variable \"X\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use strict\";\r\n\r\nimport {\r\n    Sheet,\r\n    SheetContent,\r\n    SheetHeader,\r\n    SheetTitle,\r\n    SheetDescription,\r\n} from \"@/components/ui/sheet\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { X, MessageSquare, FileText, Info } from \"lucide-react\";\r\nimport { RoadmapItem, RoadmapStage } from \"@/lib/roadmapTypes\";\r\nimport { NodeContextChat } from \"./NodeContextChat\";\r\nimport { NodeAttachments } from \"./NodeAttachments\";\r\nimport { NodeActions } from \"./NodeActions\";\r\nimport { Rocket } from \"lucide-react\";\r\n\r\ninterface NodeDrawerProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    selectedNode: RoadmapItem | RoadmapStage | null;\r\n    projectId: string;\r\n}\r\n\r\nexport function NodeDrawer({\r\n    isOpen,\r\n    onClose,\r\n    selectedNode,\r\n    projectId,\r\n}: NodeDrawerProps) {\r\n    if (!selectedNode) return null;\r\n\r\n    const isStage = \"stageOrder\" in selectedNode;\r\n    const title = isStage ? (selectedNode as RoadmapStage).name : (selectedNode as RoadmapItem).title;\r\n    const description = isStage ? \"\" : (selectedNode as RoadmapItem).description;\r\n\r\n    return (\r\n        <Sheet open={isOpen} onOpenChange={(open) => !open && onClose()}>\r\n            <SheetContent className=\"w-[400px] sm:w-[540px] flex flex-col p-0 gap-0\" side=\"right\">\r\n                {/* Header */}\r\n                <div className=\"p-6 border-b bg-muted/20\">\r\n                    <SheetHeader className=\"mb-4\">\r\n                        <SheetTitle className=\"text-xl font-cal leading-tight\">{title}</SheetTitle>\r\n                        <SheetDescription className=\"line-clamp-2\">\r\n                            {description || \"Explore deeper context for this milestone.\"}\r\n                        </SheetDescription>\r\n                    </SheetHeader>\r\n\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className={`px-2 py-0.5 rounded-full text-xs font-medium uppercase tracking-wider ${isStage ? \"bg-primary/10 text-primary\" : \"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300\"\r\n                            }`}>\r\n                            {isStage ? \"Stage\" : \"Milestone\"}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Content Tabs */}\r\n                <Tabs defaultValue=\"chat\" className=\"flex-1 flex flex-col overflow-hidden\">\r\n                    <div className=\"px-6 pt-2 border-b\">\r\n                        <TabsList className=\"w-full justify-start bg-transparent p-0 h-auto gap-4\">\r\n                            <TabsTrigger\r\n                                value=\"chat\"\r\n                                className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-1 pb-3 pt-2 text-muted-foreground data-[state=active]:text-foreground\"\r\n                            >\r\n                                <MessageSquare className=\"w-4 h-4 mr-2\" />\r\n                                Context Chat\r\n                            </TabsTrigger>\r\n                            <TabsTrigger\r\n                                value=\"files\"\r\n                                className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-1 pb-3 pt-2 text-muted-foreground data-[state=active]:text-foreground\"\r\n                            >\r\n                                <FileText className=\"w-4 h-4 mr-2\" />\r\n                                Files\r\n                            </TabsTrigger>\r\n                            <TabsTrigger\r\n                                value=\"actions\"\r\n                                className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-1 pb-3 pt-2 text-muted-foreground data-[state=active]:text-foreground\"\r\n                            >\r\n                                <Rocket className=\"w-4 h-4 mr-2\" />\r\n                                Actions\r\n                            </TabsTrigger>\r\n                            <TabsTrigger\r\n                                value=\"details\"\r\n                                className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-1 pb-3 pt-2 text-muted-foreground data-[state=active]:text-foreground\"\r\n                            >\r\n                                <Info className=\"w-4 h-4 mr-2\" />\r\n                                Details\r\n                            </TabsTrigger>\r\n                        </TabsList>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 overflow-hidden bg-background\">\r\n                        <TabsContent value=\"chat\" className=\"h-full m-0 data-[state=inactive]:hidden flex flex-col\">\r\n                            <NodeContextChat\r\n                                nodeId={selectedNode.id}\r\n                                nodeTitle={title}\r\n                                nodeDescription={description}\r\n                                projectId={projectId}\r\n                            />\r\n                        </TabsContent>\r\n\r\n                        <TabsContent value=\"files\" className=\"h-full m-0 p-0 data-[state=inactive]:hidden\">\r\n                            <NodeAttachments nodeId={selectedNode.id} />\r\n                        </TabsContent>\r\n\r\n                        <TabsContent value=\"actions\" className=\"h-full m-0 p-0 data-[state=inactive]:hidden\">\r\n                            <NodeActions nodeId={selectedNode.id} nodeTitle={title} />\r\n                        </TabsContent>\r\n\r\n                        <TabsContent value=\"details\" className=\"h-full m-0 p-6 data-[state=inactive]:hidden\">\r\n                            <ScrollArea className=\"h-full pr-4\">\r\n                                <div className=\"space-y-4\">\r\n                                    <div>\r\n                                        <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Description</h4>\r\n                                        <p className=\"text-sm leading-relaxed\">{description || \"No description provided.\"}</p>\r\n                                    </div>\r\n                                    <div>\r\n                                        <h4 className=\"text-sm font-medium text-muted-foreground mb-1\">Raw ID</h4>\r\n                                        <code className=\"text-xs bg-muted p-1 rounded block\">{selectedNode.id}</code>\r\n                                    </div>\r\n                                </div>\r\n                            </ScrollArea>\r\n                        </TabsContent>\r\n                    </div>\r\n                </Tabs>\r\n            </SheetContent>\r\n        </Sheet>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\OSNode.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":80,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":80,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[2710,2723],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { memo } from \"react\";\r\nimport { Handle, Position, NodeProps } from \"reactflow\";\r\nimport { RoadmapNodeData } from \"@/lib/roadmapTypes\";\r\nimport { OSModuleData } from \"@/lib/os-blocks\";\r\nimport { MetricBlock } from \"./blocks/MetricBlock\";\r\nimport { ChartBlock } from \"./blocks/ChartBlock\";\r\nimport { TableBlock } from \"./blocks/TableBlock\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst MarkdownBlock = ({ content }: { content: string }) => (\r\n    <div className=\"p-6 rounded-xl border bg-card text-card-foreground shadow-sm h-full overflow-auto text-sm prose prose-neutral dark:prose-invert max-w-none\">\r\n        {content}\r\n    </div>\r\n);\r\n\r\nexport const OSNode = memo(({ data, selected }: NodeProps<RoadmapNodeData>) => {\r\n    // Extract OS Module Data safely\r\n    const itemData = data.itemData;\r\n    const metadata = itemData?.metadata;\r\n\r\n    if (metadata?.type !== \"os_module\" || !metadata.data) {\r\n        return (\r\n            <div className=\"p-4 bg-destructive/10 border border-destructive rounded-lg text-sm text-destructive\">\r\n                Invalid OS Module Data\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const moduleData = metadata.data as OSModuleData;\r\n    const { title, description, layout } = moduleData;\r\n\r\n    // Determine Theme based on Module Type\r\n    const moduleType = (metadata.moduleType as string) || \"default\";\r\n\r\n    const THEMES = {\r\n        hq: {\r\n            border: \"border-amber-500/50\",\r\n            ring: \"ring-amber-500/20\",\r\n            bg: \"bg-amber-500/5\",\r\n            header: \"bg-amber-500/10\",\r\n            icon: \"bg-amber-500\",\r\n            text: \"text-amber-500\"\r\n        },\r\n        market: {\r\n            border: \"border-cyan-500/50\",\r\n            ring: \"ring-cyan-500/20\",\r\n            bg: \"bg-cyan-500/5\",\r\n            header: \"bg-cyan-500/10\",\r\n            icon: \"bg-cyan-500\",\r\n            text: \"text-cyan-500\"\r\n        },\r\n        product: {\r\n            border: \"border-violet-500/50\",\r\n            ring: \"ring-violet-500/20\",\r\n            bg: \"bg-violet-500/5\",\r\n            header: \"bg-violet-500/10\",\r\n            icon: \"bg-violet-500\",\r\n            text: \"text-violet-500\"\r\n        },\r\n        gtm: {\r\n            border: \"border-emerald-500/50\",\r\n            ring: \"ring-emerald-500/20\",\r\n            bg: \"bg-emerald-500/5\",\r\n            header: \"bg-emerald-500/10\",\r\n            icon: \"bg-emerald-500\",\r\n            text: \"text-emerald-500\"\r\n        },\r\n        default: {\r\n            border: \"border-border\",\r\n            ring: \"ring-primary/10\",\r\n            bg: \"bg-background/95\",\r\n            header: \"bg-muted/30\",\r\n            icon: \"bg-primary\",\r\n            text: \"text-primary\"\r\n        }\r\n    };\r\n\r\n    // @ts-ignore\r\n    const theme = THEMES[moduleType] || THEMES.default;\r\n\r\n    // Determine width based on content complexity (Adaptive Container)\r\n    const hasComplexBlocks = layout.some(b => b.type === \"chart\" || b.type === \"table\" || (b.colSpan ?? 1) > 2);\r\n    const isWide = hasComplexBlocks || layout.length > 3;\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                // Base: Notion-style card (Clean, simple border, no heavy shadow)\r\n                \"rounded-lg border transition-all duration-200 group bg-card text-card-foreground\",\r\n                // Hover: Subtle lift, no glow\r\n                selected ? `ring-2 ring-offset-1 ring-offset-background ${theme.ring} ${theme.border}` : `hover:border-primary/30 ${theme.border}`,\r\n                // Blueprint Mode: This will auto-adapt because --card and --border are redefined in globals.css\r\n                isWide ? \"w-[1000px]\" : \"w-[480px]\"\r\n            )}\r\n        >\r\n            {/* Header */}\r\n            <div className={cn(\"px-5 py-3 border-b flex items-center justify-between\", theme.header, theme.border)}>\r\n                <div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {/* Status Dot (Static, no pulse) */}\r\n                        <div className={cn(\"w-2.5 h-2.5 rounded-full\", theme.icon)} />\r\n                        {/* Title: Serif/Sans mix for Notion feel */}\r\n                        <h3 className={cn(\"font-heading font-semibold text-lg tracking-tight\", theme.text)}>{title}</h3>\r\n                    </div>\r\n                    {description && <p className=\"text-xs text-muted-foreground mt-0.5 ml-4.5\">{description}</p>}\r\n                </div>\r\n                {/* Type Badge (Minimalist) */}\r\n                <span className={cn(\"text-[10px] font-mono uppercase tracking-wider px-1.5 py-0.5 rounded-md border opacity-70\", theme.border, theme.text)}>\r\n                    {moduleType}\r\n                </span>\r\n            </div>\r\n\r\n            {/* Grid Layout */}\r\n            <div className={cn(\r\n                \"p-6 grid gap-6\",\r\n                isWide ? \"grid-cols-4\" : \"grid-cols-2\"\r\n            )}>\r\n                {layout.map((block, i) => {\r\n                    const span = block.colSpan ?? 1;\r\n                    const colSpan = `col-span-${span}`;\r\n\r\n                    return (\r\n                        <div key={block.id || i} className={cn(colSpan, \"min-h-[140px]\")}>\r\n                            {block.type === \"metric\" && <MetricBlock block={block} />}\r\n                            {block.type === \"chart\" && <ChartBlock block={block} />}\r\n                            {block.type === \"table\" && <TableBlock block={block} />}\r\n                            {block.type === \"markdown\" && <MarkdownBlock content={block.content || \"\"} />}\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            {/* Connection Handles (Minimal, only show on hover/select to keep clean) */}\r\n            <Handle type=\"target\" position={Position.Top} className=\"!bg-muted-foreground/30 !w-2 !h-2 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n            <Handle type=\"source\" position={Position.Bottom} className=\"!bg-muted-foreground/30 !w-2 !h-2 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n            <Handle type=\"target\" position={Position.Left} className=\"!bg-muted-foreground/30 !w-2 !h-2 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n            <Handle type=\"source\" position={Position.Right} className=\"!bg-muted-foreground/30 !w-2 !h-2 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n        </div>\r\n    );\r\n});\r\n\r\nOSNode.displayName = \"OSNode\";\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\TechnicalNode.tsx","messages":[{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\TechnicalNode.tsx:75:22\n  73 |                 {/* Status Icon */}\n  74 |                 <div className=\"mt-0.5\">\n> 75 |                     <StatusIcon />\n     |                      ^^^^^^^^^^ This component is created during render\n  76 |                 </div>\n  77 |\n  78 |                 {/* Content */}\n\nC:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\TechnicalNode.tsx:47:24\n  45 |\n  46 |     // Status icon based on node state\n> 47 |     const StatusIcon = () => {\n     |                        ^^^^^^^\n> 48 |         switch (status) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 49 |             case \"completed\":\n     â€¦\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 57 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 58 |     };\n     | ^^^^^^ The component is created during render here\n  59 |\n  60 |     return (\n  61 |         <div","line":75,"column":22,"nodeType":null,"endLine":75,"endColumn":32}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { memo } from \"react\";\r\nimport { Handle, Position } from \"reactflow\";\r\nimport { CheckCircle2, Circle, Lock, Sparkles } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nimport type { RoadmapNodeData, NodeStatus } from \"@/lib/roadmapTypes\";\r\nimport { MetricBlock } from \"@/components/canvas/MetricBlock\";\r\n\r\ninterface TechnicalNodeProps {\r\n    data: RoadmapNodeData;\r\n    selected?: boolean;\r\n}\r\n\r\n// Visual styling based on node status\r\nconst STATUS_STYLES: Record<NodeStatus, { border: string; opacity: string; accent: string }> = {\r\n    active: {\r\n        border: \"border-orange-500 border-2\",\r\n        opacity: \"opacity-100\",\r\n        accent: \"text-orange-500\",\r\n    },\r\n    completed: {\r\n        border: \"border-green-500 border\",\r\n        opacity: \"opacity-70\",\r\n        accent: \"text-green-500\",\r\n    },\r\n    projected: {\r\n        border: \"border-blue-500 border-dashed\",\r\n        opacity: \"opacity-40\",\r\n        accent: \"text-blue-500\",\r\n    },\r\n    locked: {\r\n        border: \"border-muted-foreground/40 border-dotted\",\r\n        opacity: \"opacity-25\",\r\n        accent: \"text-muted-foreground\",\r\n    },\r\n};\r\n\r\nexport const TechnicalNode = memo(({ data, selected }: TechnicalNodeProps) => {\r\n    const isCompleted = data.isCompleted || data.nodeStatus === \"completed\";\r\n    const isStage = data.type === \"stage\";\r\n\r\n    // Determine status from data or infer from isCompleted\r\n    const status: NodeStatus = data.nodeStatus || (isCompleted ? \"completed\" : \"active\");\r\n    const styles = STATUS_STYLES[status];\r\n\r\n    // Status icon based on node state\r\n    const StatusIcon = () => {\r\n        switch (status) {\r\n            case \"completed\":\r\n                return <CheckCircle2 className=\"w-4 h-4 text-green-500\" />;\r\n            case \"projected\":\r\n                return <Sparkles className=\"w-4 h-4 text-blue-500\" />;\r\n            case \"locked\":\r\n                return <Lock className=\"w-4 h-4 text-muted-foreground/50\" />;\r\n            default:\r\n                return <Circle className={cn(\"w-4 h-4\", styles.accent)} />;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                \"relative min-w-[200px] bg-background px-4 py-3 shadow-sm transition-all duration-300 rounded-sm\",\r\n                styles.border,\r\n                styles.opacity,\r\n                selected && \"ring-2 ring-offset-2 ring-orange-500/50 bg-gray-50 dark:bg-zinc-900\"\r\n            )}\r\n        >\r\n            {/* Handles */}\r\n            <Handle type=\"target\" position={Position.Top} className=\"!bg-muted-foreground !w-1 !h-1 !min-w-[4px] !min-h-[4px]\" />\r\n\r\n            <div className=\"flex items-start gap-3\">\r\n                {/* Status Icon */}\r\n                <div className=\"mt-0.5\">\r\n                    <StatusIcon />\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"w-full\">\r\n                    <h3 className={cn(\r\n                        \"font-medium text-sm font-heading\",\r\n                        isStage && \"uppercase tracking-wider text-xs\",\r\n                        status === \"projected\" && \"text-blue-400\"\r\n                    )}>\r\n                        {data.label}\r\n                    </h3>\r\n                    {data.itemData?.category && (\r\n                        <span className=\"text-[10px] text-muted-foreground uppercase font-mono mt-1 block\">\r\n                            {data.itemData.category}\r\n                        </span>\r\n                    )}\r\n                    {status === \"projected\" && (\r\n                        <span className=\"text-[9px] text-blue-400 uppercase font-mono mt-1 block\">\r\n                            Future Milestone\r\n                        </span>\r\n                    )}\r\n\r\n                    {/* Live Metrics */}\r\n                    {(data.itemData?.id || data.stageData?.id) && (\r\n                        <MetricBlock nodeId={data.itemData?.id || data.stageData?.id || \"\"} />\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <Handle type=\"source\" position={Position.Bottom} className=\"!bg-muted-foreground !w-1 !h-1 !min-w-[4px] !min-h-[4px]\" />\r\n        </div>\r\n    );\r\n});\r\n\r\nTechnicalNode.displayName = \"TechnicalNode\";\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\blocks\\ChartBlock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\blocks\\MetricBlock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\canvas\\blocks\\TableBlock.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[805,808],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[805,808],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\r\nimport { TableBlock as TableBlockType } from \"@/lib/os-blocks\";\r\n\r\n// Removed Shadcn imports to ensure stability\r\n// import {\r\n//   Table,\r\n//   TableBody,\r\n//   TableCell,\r\n//   TableHead,\r\n//   TableHeader,\r\n//   TableRow,\r\n// } from \"@/components/ui/table\"; \r\n\r\ninterface TableBlockProps {\r\n    block: TableBlockType;\r\n}\r\n\r\nexport function TableBlock({ block }: TableBlockProps) {\r\n    const { title, columns, data } = block;\r\n\r\n    if (!columns || !data || data.length === 0) {\r\n        return (\r\n            <div className=\"p-4 rounded-xl border bg-card text-card-foreground shadow-sm h-full flex items-center justify-center text-muted-foreground text-sm\">\r\n                No table data available\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const formatValue = (value: any, format?: string | null) => {\r\n        if (value === null || value === undefined) return \"-\";\r\n        if (format === \"currency\") return `$${value.toLocaleString()}`;\r\n        if (format === \"percent\") return `${value}%`;\r\n        return value;\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 rounded-xl border bg-card text-card-foreground shadow-sm h-full overflow-hidden flex flex-col\">\r\n            {title && <h4 className=\"text-sm font-medium mb-3\">{title}</h4>}\r\n            <div className=\"flex-1 overflow-auto -mx-4 px-4\">\r\n                {/* Simple Table Implementation */}\r\n                <table className=\"w-full text-sm text-left border-collapse\">\r\n                    <thead className=\"text-xs uppercase text-muted-foreground bg-muted/50 sticky top-0 font-display tracking-wider\">\r\n                        <tr>\r\n                            {columns.map((col) => (\r\n                                <th key={col.key} className=\"px-5 py-4 font-medium text-left\">\r\n                                    {col.label}\r\n                                </th>\r\n                            ))}\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-border\">\r\n                        {data.map((row, i) => (\r\n                            <tr key={i} className=\"hover:bg-muted/50 transition-colors\">\r\n                                {columns.map((col) => (\r\n                                    <td key={col.key} className=\"px-5 py-4 align-top border-b border-border/50\">\r\n                                        {formatValue(row[col.key], col.format)}\r\n                                    </td>\r\n                                ))}\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\dashboard\\QuickStartInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\layout\\AppHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\layout\\UserMenu.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserIcon' is defined but never used.","line":5,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":34,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UserIcon"},"fix":{"range":[133,151],"text":""},"desc":"Remove unused variable \"UserIcon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":5,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":44,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Settings"},"fix":{"range":[151,161],"text":""},"desc":"Remove unused variable \"Settings\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { User } from \"@supabase/supabase-js\";\r\nimport { LogOut, User as UserIcon, Settings, ChevronDown } from \"lucide-react\";\r\nimport { signOutAction } from \"@/actions/auth\";\r\n\r\ninterface UserMenuProps {\r\n    user: User;\r\n    pseudonym: string;\r\n}\r\n\r\nexport function UserMenu({ user, pseudonym }: UserMenuProps) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const menuRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Close on click outside\r\n    useEffect(() => {\r\n        function handleClickOutside(event: MouseEvent) {\r\n            if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n                setIsOpen(false);\r\n            }\r\n        }\r\n        document.addEventListener(\"mousedown\", handleClickOutside);\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"relative\" ref={menuRef}>\r\n            <button\r\n                onClick={() => setIsOpen(!isOpen)}\r\n                className=\"flex items-center gap-3 bg-muted/50 pl-3 pr-4 py-1.5 rounded-full border border-border/50 shadow-sm backdrop-blur-md hover:bg-muted/80 transition-all group cursor-pointer\"\r\n            >\r\n                <div className=\"w-6 h-6 rounded-full bg-gradient-to-tr from-orange-400 to-blue-500 flex items-center justify-center text-[10px] text-white font-bold shadow-inner ring-2 ring-transparent group-hover:ring-orange-500/20 transition-all\">\r\n                    {pseudonym[0]}\r\n                </div>\r\n                <span className=\"text-sm font-medium hidden sm:inline-block text-foreground/90\">\r\n                    {pseudonym}\r\n                </span>\r\n                <ChevronDown className={`w-3 h-3 text-muted-foreground transition-transform duration-200 ${isOpen ? \"rotate-180\" : \"\"}`} />\r\n            </button>\r\n\r\n            {/* Dropdown */}\r\n            {isOpen && (\r\n                <div className=\"absolute right-0 mt-2 w-56 bg-card border border-border rounded-xl shadow-lg shadow-black/5 animate-in fade-in zoom-in-95 duration-100 origin-top-right overflow-hidden z-50\">\r\n                    {/* User Info Header */}\r\n                    <div className=\"px-4 py-3 border-b border-border/50 bg-muted/30\">\r\n                        <p className=\"text-sm font-medium text-foreground\">{pseudonym}</p>\r\n                        <p className=\"text-xs text-muted-foreground truncate opacity-80\">{user.email}</p>\r\n                    </div>\r\n\r\n                    {/* Actions */}\r\n                    <div className=\"p-1\">\r\n                        {/* \r\n                           Future Placeholders: \r\n                           - Settings\r\n                           - Billing \r\n                        */}\r\n\r\n                        <form action={signOutAction}>\r\n                            <button\r\n                                type=\"submit\"\r\n                                className=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-lg transition-colors\"\r\n                            >\r\n                                <LogOut className=\"w-4 h-4\" />\r\n                                <span>Sign out</span>\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\os\\DynamicOSRenderer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\os\\blocks\\ChartBlock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\os\\blocks\\ContentBlock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\os\\blocks\\MetricBlock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\os\\blocks\\TableBlock.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\providers\\WalletProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\PielyLogo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\RotatingStatus.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\ThemeToggle.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\ThemeToggle.tsx:14:9\n  12 |         const prefersDark = stored === \"dark\" || (!stored && true); // Default dark\n  13 |\n> 14 |         setIsDark(prefersDark);\n     |         ^^^^^^^^^ Avoid calling setState() directly within an effect\n  15 |         document.documentElement.classList.toggle(\"dark\", prefersDark);\n  16 |     }, []);\n  17 |","line":14,"column":9,"nodeType":null,"endLine":14,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Moon, Sun } from \"lucide-react\";\r\n\r\nexport function ThemeToggle() {\r\n    const [isDark, setIsDark] = useState(true); // Default to dark\r\n\r\n    useEffect(() => {\r\n        // Check localStorage or default to dark\r\n        const stored = localStorage.getItem(\"theme\");\r\n        const prefersDark = stored === \"dark\" || (!stored && true); // Default dark\r\n\r\n        setIsDark(prefersDark);\r\n        document.documentElement.classList.toggle(\"dark\", prefersDark);\r\n    }, []);\r\n\r\n    const toggleTheme = () => {\r\n        const newValue = !isDark;\r\n        setIsDark(newValue);\r\n        document.documentElement.classList.toggle(\"dark\", newValue);\r\n        localStorage.setItem(\"theme\", newValue ? \"dark\" : \"light\");\r\n    };\r\n\r\n    return (\r\n        <button\r\n            onClick={toggleTheme}\r\n            className=\"p-2 rounded-lg bg-muted/50 border border-border/50 hover:bg-muted/80 transition-all\"\r\n            aria-label=\"Toggle theme\"\r\n        >\r\n            {isDark ? (\r\n                <Sun className=\"w-4 h-4 text-orange-400\" />\r\n            ) : (\r\n                <Moon className=\"w-4 h-4 text-gray-600\" />\r\n            )}\r\n        </button>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\campus-layout.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\database.types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\layoutEngine.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RoadmapStage' is defined but never used.","line":3,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RoadmapStage"},"fix":{"range":[31,47],"text":""},"desc":"Remove unused variable \"RoadmapStage\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RoadmapItem' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RoadmapItem"},"fix":{"range":[47,62],"text":""},"desc":"Remove unused variable \"RoadmapItem\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'positions' is assigned a value but never used.","line":23,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2398,2401],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2398,2401],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'calculateRadialLayout' is defined but never used.","line":153,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":153,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'calculateFlowLayout' is defined but never used.","line":182,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":182,"endColumn":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type {\n  RoadmapResponse,\n  RoadmapStage,\n  RoadmapItem,\n  LayoutType,\n} from \"@/lib/roadmapTypes\";\n\nexport interface NodePosition {\n  id: string;\n  x: number;\n  y: number;\n}\n\nimport dagre from \"dagre\";\n\n// ... (keep interface NodePosition)\n\nexport function calculateLayout(\n  roadmap: RoadmapResponse,\n  layoutTypeOverride?: LayoutType // Allow overriding the roadmap's default\n): Map<string, NodePosition> {\n  const layoutType = layoutTypeOverride || roadmap.layoutType || \"swimlanes\";\n  const positions = new Map<string, NodePosition>();\n\n  switch (layoutType) {\n    case \"timeline\":\n      return calculateTimelineLayout(roadmap);\n    case \"tree\":\n      return calculateTreeLayout(roadmap);\n    case \"swimlanes\":\n      return calculateSwimlanesLayout(roadmap);\n    // ...\n    default:\n      return calculateSwimlanesLayout(roadmap);\n  }\n}\n\n// ... (keep calculateTimelineLayout)\n\nfunction calculateTimelineLayout(roadmap: RoadmapResponse): Map<string, NodePosition> {\n  const positions = new Map<string, NodePosition>();\n  const sortedStages = [...roadmap.stages].sort((a, b) => a.stageOrder - b.stageOrder);\n  const stageWidth = 350;\n  const stageY = 100;\n  const itemSpacing = 100;\n\n  sortedStages.forEach((stage, stageIndex) => {\n    const stageX = stageIndex * stageWidth;\n    positions.set(stage.id, { id: stage.id, x: stageX, y: stageY });\n\n    const stageItems = roadmap.items.filter((item) => item.stageId === stage.id);\n    stageItems.forEach((item, itemIndex) => {\n      const itemX = stageX;\n      const itemY = stageY + 150 + itemIndex * itemSpacing;\n      positions.set(item.id, { id: item.id, x: itemX, y: itemY });\n    });\n  });\n\n  return positions;\n}\n\nfunction calculateTreeLayout(roadmap: RoadmapResponse): Map<string, NodePosition> {\n  const positions = new Map<string, NodePosition>();\n  const g = new dagre.graphlib.Graph();\n\n  g.setGraph({\n    rankdir: \"TB\", // Top-to-Bottom\n    nodesep: 100,  // Horizontal spacing\n    ranksep: 200,  // Vertical spacing\n    align: \"UL\"    // Align upper-left \n  });\n  g.setDefaultEdgeLabel(() => ({}));\n\n  // 1. Add Nodes\n  const sortedStages = [...roadmap.stages].sort((a, b) => a.stageOrder - b.stageOrder);\n\n  sortedStages.forEach(stage => {\n    g.setNode(stage.id, { width: 300, height: 100 });\n  });\n  roadmap.items.forEach(item => {\n    // OSModules are wider, check metadata if available\n    const isWide = (item.metadata as any)?.layout?.length > 4;\n    g.setNode(item.id, { width: isWide ? 500 : 350, height: 150 });\n  });\n\n  // 2. Add Edges\n  // If we have explicit edges, use them\n  if (roadmap.edges && roadmap.edges.length > 0) {\n    roadmap.edges.forEach(edge => {\n      g.setEdge(edge.from, edge.to);\n    });\n  } else {\n    // FALLBACK: If no edges exist, Create a Synthetic Hierarchy:\n    // Stages -> Items in that stage\n    sortedStages.forEach((stage, idx) => {\n      // Connect stages sequentially\n      if (idx > 0) {\n        g.setEdge(sortedStages[idx - 1].id, stage.id);\n      }\n\n      // Connect stage to its items\n      const stageItems = roadmap.items.filter(i => i.stageId === stage.id);\n      stageItems.forEach(item => {\n        g.setEdge(stage.id, item.id);\n      });\n    });\n  }\n\n  // 3. Compute Layout\n  dagre.layout(g);\n\n  // 4. Extract Positions\n  g.nodes().forEach(nodeId => {\n    const node = g.node(nodeId);\n    // Dagre gives center coords, we might need top-left depending on ReactFlow anchor\n    // ReactFlow default is top-left, but with handles it Centers? \n    // Usually ReactFlow 'position' is Top-Left. Dagre gives Center.\n    // Let's adjust:\n    positions.set(nodeId, {\n      id: nodeId,\n      x: node.x - (node.width / 2),\n      y: node.y - (node.height / 2)\n    });\n  });\n\n  return positions;\n}\n\nfunction calculateSwimlanesLayout(roadmap: RoadmapResponse): Map<string, NodePosition> {\n  const positions = new Map<string, NodePosition>();\n  const sortedStages = [...roadmap.stages].sort((a, b) => a.stageOrder - b.stageOrder);\n  // Expanded spacing for \"Accelerator Path\" visual effect\n  const laneWidth = 500;\n  const stageGap = 100; // Extra gap between stages\n  const laneHeight = 280;\n  const itemSpacing = 130;\n\n  sortedStages.forEach((stage, stageIndex) => {\n    const stageX = stageIndex * (laneWidth + stageGap);\n    positions.set(stage.id, { id: stage.id, x: stageX, y: 0 });\n\n    const stageItems = roadmap.items.filter((item) => item.stageId === stage.id);\n    stageItems.forEach((item, itemIndex) => {\n      const itemX = stageX + 50; // Slight offset from stage node\n      const itemY = laneHeight + (itemIndex % 4) * itemSpacing + Math.floor(itemIndex / 4) * 50;\n      positions.set(item.id, { id: item.id, x: itemX, y: itemY });\n    });\n  });\n\n  return positions;\n}\n\nfunction calculateRadialLayout(roadmap: RoadmapResponse): Map<string, NodePosition> {\n  const positions = new Map<string, NodePosition>();\n  const sortedStages = [...roadmap.stages].sort((a, b) => a.stageOrder - b.stageOrder);\n  const centerX = 500;\n  const centerY = 400;\n  const radius = 300;\n  const angleStep = (2 * Math.PI) / sortedStages.length;\n\n  sortedStages.forEach((stage, stageIndex) => {\n    const angle = stageIndex * angleStep - Math.PI / 2;\n    const stageX = centerX + radius * Math.cos(angle);\n    const stageY = centerY + radius * Math.sin(angle);\n    positions.set(stage.id, { id: stage.id, x: stageX, y: stageY });\n\n    const stageItems = roadmap.items.filter((item) => item.stageId === stage.id);\n    const itemRadius = radius * 0.6;\n    const itemAngleStep = angleStep / Math.max(stageItems.length, 1);\n\n    stageItems.forEach((item, itemIndex) => {\n      const itemAngle = angle + (itemIndex - stageItems.length / 2) * itemAngleStep;\n      const itemX = centerX + itemRadius * Math.cos(itemAngle);\n      const itemY = centerY + itemRadius * Math.sin(itemAngle);\n      positions.set(item.id, { id: item.id, x: itemX, y: itemY });\n    });\n  });\n\n  return positions;\n}\n\nfunction calculateFlowLayout(roadmap: RoadmapResponse): Map<string, NodePosition> {\n  const positions = new Map<string, NodePosition>();\n  const sortedStages = [...roadmap.stages].sort((a, b) => a.stageOrder - b.stageOrder);\n  const stageSpacing = 300;\n  const itemOffsetX = 150;\n  const itemSpacingY = 80;\n\n  sortedStages.forEach((stage, stageIndex) => {\n    const stageX = stageIndex * stageSpacing;\n    const stageY = 200;\n    positions.set(stage.id, { id: stage.id, x: stageX, y: stageY });\n\n    const stageItems = roadmap.items.filter((item) => item.stageId === stage.id);\n    stageItems.forEach((item, itemIndex) => {\n      const itemX = stageX + itemOffsetX;\n      const itemY = stageY + (itemIndex - stageItems.length / 2) * itemSpacingY;\n      positions.set(item.id, { id: item.id, x: itemX, y: itemY });\n    });\n  });\n\n  return positions;\n}\n\nexport function applyLayoutHints(\n  positions: Map<string, NodePosition>,\n  roadmap: RoadmapResponse,\n): Map<string, NodePosition> {\n  if (!roadmap.layoutHints) return positions;\n\n  const updated = new Map(positions);\n\n  Object.entries(roadmap.layoutHints).forEach(([nodeId, hints]) => {\n    const current = updated.get(nodeId);\n    if (!current) return;\n\n    updated.set(nodeId, {\n      id: nodeId,\n      x: hints.suggestedX ?? current.x,\n      y: hints.suggestedY ?? current.y,\n    });\n  });\n\n  return updated;\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\os-blocks.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[914,917],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[914,917],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1199,1202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1199,1202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export type BlockType = \"metric\" | \"chart\" | \"table\" | \"markdown\";\r\n\r\nexport interface BaseBlock {\r\n    id: string;\r\n    type: BlockType;\r\n    title?: string | null;\r\n    colSpan?: number | null; // Changed to number | null to match Zod transform\r\n}\r\n\r\nexport interface MetricBlock extends BaseBlock {\r\n    type: \"metric\";\r\n    label: string | null;\r\n    value: string | number | null;\r\n    trend?: {\r\n        value: number;\r\n        direction: \"up\" | \"down\" | \"neutral\";\r\n        label?: string | null;\r\n    } | null;\r\n    details?: string | null;\r\n    variant?: \"default\" | \"highlight\" | \"danger\" | \"success\" | null;\r\n}\r\n\r\nexport interface ChartBlock extends BaseBlock {\r\n    type: \"chart\";\r\n    chartType: \"bar\" | \"line\" | \"area\" | \"pie\" | null;\r\n    dataKey: string | null;\r\n    series: {\r\n        key: string;\r\n        label: string;\r\n        color?: string | null;\r\n    }[] | null;\r\n    data: Record<string, any>[] | null;\r\n    height?: number;\r\n}\r\n\r\nexport interface TableBlock extends BaseBlock {\r\n    type: \"table\";\r\n    columns: {\r\n        key: string;\r\n        label: string;\r\n        format?: \"currency\" | \"percent\" | \"number\" | \"text\" | null;\r\n    }[] | null;\r\n    data: Record<string, any>[] | null;\r\n}\r\n\r\nexport interface MarkdownBlock extends BaseBlock {\r\n    type: \"markdown\";\r\n    content: string | null;\r\n}\r\n\r\nexport type OSBlock = MetricBlock | ChartBlock | TableBlock | MarkdownBlock;\r\n\r\nexport interface OSModuleData {\r\n    title: string;\r\n    description?: string | null;\r\n    layout: OSBlock[];\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\research.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\roadmapSchema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\roadmapTypes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\schemas\\os-modules.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\stages.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\toolRegistry.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'nodeType' is defined but never used.","line":55,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":60}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { LucideIcon, Globe, Briefcase, BadgeDollarSign, Rocket } from \"lucide-react\";\r\n\r\nexport type ToolId = \"deploy_vercel\" | \"incorporate_stripe\" | \"setup_bank\" | \"create_entity\";\r\n\r\nexport interface ToolDefinition {\r\n    id: ToolId;\r\n    name: string;\r\n    description: string;\r\n    icon: LucideIcon;\r\n    actionUrl?: string; // For external links\r\n    isAutomated: boolean; // True if handled by server action, False if just a guide/link\r\n    requiredInputs?: {\r\n        key: string;\r\n        label: string;\r\n        type: \"text\" | \"url\" | \"select\";\r\n    }[];\r\n}\r\n\r\nexport const ACTION_REGISTRY: Record<ToolId, ToolDefinition> = {\r\n    deploy_vercel: {\r\n        id: \"deploy_vercel\",\r\n        name: \"Deploy to Vercel\",\r\n        description: \"Launch your MVP to a live URL.\",\r\n        icon: Rocket,\r\n        isAutomated: true, // We'll mock the automation\r\n        requiredInputs: [\r\n            { key: \"repoUrl\", label: \"GitHub Repo URL\", type: \"url\" },\r\n        ]\r\n    },\r\n    incorporate_stripe: {\r\n        id: \"incorporate_stripe\",\r\n        name: \"Incorporate via Atlas\",\r\n        description: \"Form your Delaware C-Corp.\",\r\n        icon: Globe,\r\n        actionUrl: \"https://atlas.stripe.com\",\r\n        isAutomated: false\r\n    },\r\n    create_entity: {\r\n        id: \"create_entity\",\r\n        name: \"Register Legal Entity\",\r\n        description: \"Legal formation documentation.\",\r\n        icon: Briefcase,\r\n        isAutomated: false\r\n    },\r\n    setup_bank: {\r\n        id: \"setup_bank\",\r\n        name: \"Open Bank Account\",\r\n        description: \"Mercury or Brex setup.\",\r\n        icon: BadgeDollarSign,\r\n        isAutomated: false\r\n    }\r\n};\r\n\r\n// Map Node Types (or titles/categories) to compatible Tools\r\nexport function getToolsForNode(nodeTitle: string, nodeType?: string): ToolDefinition[] {\r\n    const tools: ToolDefinition[] = [];\r\n    const lowerTitle = nodeTitle.toLowerCase();\r\n\r\n    if (lowerTitle.includes(\"deploy\") || lowerTitle.includes(\"hosting\") || lowerTitle.includes(\"mvp\")) {\r\n        tools.push(ACTION_REGISTRY.deploy_vercel);\r\n    }\r\n\r\n    if (lowerTitle.includes(\"incorporate\") || lowerTitle.includes(\"legal\") || lowerTitle.includes(\"entity\")) {\r\n        tools.push(ACTION_REGISTRY.incorporate_stripe);\r\n        tools.push(ACTION_REGISTRY.create_entity);\r\n    }\r\n\r\n    if (lowerTitle.includes(\"bank\") || lowerTitle.includes(\"finance\")) {\r\n        tools.push(ACTION_REGISTRY.setup_bank);\r\n    }\r\n\r\n    return tools;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\utils\\ai.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\utils\\names.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\utils\\string.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\utils\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\utils\\supabase\\middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'options' is defined but never used.","line":20,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":65}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient } from \"@supabase/ssr\";\r\nimport { NextResponse, type NextRequest } from \"next/server\";\r\n\r\nexport async function updateSession(request: NextRequest) {\r\n    let response = NextResponse.next({\r\n        request: {\r\n            headers: request.headers,\r\n        },\r\n    });\r\n\r\n    const supabase = createServerClient(\r\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n        {\r\n            cookies: {\r\n                getAll() {\r\n                    return request.cookies.getAll();\r\n                },\r\n                setAll(cookiesToSet) {\r\n                    cookiesToSet.forEach(({ name, value, options }) =>\r\n                        request.cookies.set(name, value)\r\n                    );\r\n                    response = NextResponse.next({\r\n                        request: {\r\n                            headers: request.headers,\r\n                        },\r\n                    });\r\n                    cookiesToSet.forEach(({ name, value, options }) =>\r\n                        response.cookies.set(name, value, options)\r\n                    );\r\n                },\r\n            },\r\n        }\r\n    );\r\n\r\n    const {\r\n        data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (\r\n        !user &&\r\n        !request.nextUrl.pathname.startsWith(\"/auth\") &&\r\n        !request.nextUrl.pathname.startsWith(\"/\") &&\r\n        !request.nextUrl.pathname.startsWith(\"/api\") &&\r\n        // Allow static assets\r\n        !request.nextUrl.pathname.includes(\".\")\r\n    ) {\r\n        // Redirect to login if accessing protected route without user\r\n        // We allow Public Landing (/) and Auth (/auth)\r\n        const url = request.nextUrl.clone();\r\n        url.pathname = \"/auth\";\r\n        return NextResponse.redirect(url);\r\n    }\r\n\r\n    return response;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hitesh G S\\Desktop\\piely\\src\\utils\\supabase\\server.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":4,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":4,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[142,145],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[142,145],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient } from \"@supabase/ssr\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport async function createClient<Database = any>() {\r\n    const cookieStore = await cookies();\r\n\r\n    return createServerClient<Database>(\r\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n        {\r\n            cookies: {\r\n                getAll() {\r\n                    return cookieStore.getAll();\r\n                },\r\n                setAll(cookiesToSet) {\r\n                    try {\r\n                        cookiesToSet.forEach(({ name, value, options }) =>\r\n                            cookieStore.set(name, value, options)\r\n                        );\r\n                    } catch {\r\n                        // The `setAll` method was called from a Server Component.\r\n                        // This can be ignored if you have middleware refreshing\r\n                        // user sessions.\r\n                    }\r\n                },\r\n            },\r\n        }\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]}]